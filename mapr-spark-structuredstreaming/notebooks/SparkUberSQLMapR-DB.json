{"paragraphs":[{"title":"Imports","text":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\n\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\n"}]},"apps":[],"jobName":"paragraph_1531437768284_-252745780","id":"20170919-164412_663650782","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30643"},{"title":"Define the Schema","text":"  case class UberwId(_id: String, dt: java.sql.Timestamp, \n    lat: Double, lon: Double, base: String,cid: Integer, \n    clat: Double, clon: Double) extends Serializable  \n\n  val schema = StructType(Array(\n    StructField(\"_id\", StringType, true),    \n    StructField(\"dt\", TimestampType, true),\n    StructField(\"lat\", DoubleType, true),\n    StructField(\"lon\", DoubleType, true),\n    StructField(\"base\", StringType, true),\n    StructField(\"cid\", IntegerType, true),\n    StructField(\"clat\", DoubleType, true),\n    StructField(\"clon\", DoubleType, true)\n  ))\n\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class UberwId\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(_id,StringType,true), StructField(dt,TimestampType,true), StructField(lat,DoubleType,true), StructField(lon,DoubleType,true), StructField(base,StringType,true), StructField(cid,IntegerType,true), StructField(clat,DoubleType,true), StructField(clon,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1531437768284_-252745780","id":"20180614-162851_1497489065","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30644"},{"title":"Load the Data from MapR-DB into a Dataset","text":"var tableName: String = \"/apps/ubertable\"\nval df: Dataset[UberwId] = spark\n    .loadFromMapRDB[UberwId](tableName, schema)\n    .as[UberwId]\ndf.createOrReplaceTempView(\"uber\")\n\ndf.cache\ndf.count\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tableName: String = /apps/ubertable\ndf: org.apache.spark.sql.Dataset[UberwId] = [_id: string, dt: timestamp ... 6 more fields]\nres158: df.type = [_id: string, dt: timestamp ... 6 more fields]\nres159: Long = 135962\n"}]},"apps":[],"jobName":"paragraph_1531437768284_-252745780","id":"20180614-164641_1380112651","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30645"},{"title":"Show first 20 rows","text":"df.show\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-------+--------+------+---+----------------+------------------+\n|                 _id|                 dt|    lat|     lon|  base|cid|            clat|              clon|\n+--------------------+-------------------+-------+--------+------+---+----------------+------------------+\n|0_922337050559328...|2014-08-06 05:28:00|40.7663|-73.9915|B02598|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:27:00|40.7674|-73.9848|B02682|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:27:00|40.7564|-73.9975|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:26:00| 40.768|-73.9833|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:26:00|40.7656|-73.9636|B02598|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:25:00|40.7499|-73.9895|B02764|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:25:00|40.7772|-73.9783|B02598|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00| 40.754|-73.9681|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00| 40.754|-73.9681|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00|40.7507|-74.0021|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00|40.7507|-74.0021|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00|40.7746|-73.9899|B02598|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:24:00|40.7332|-73.9755|B02598|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:23:00|40.7703|-73.9686|B02682|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:23:00|40.7372|-73.9784|B02682|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:23:00| 40.758|-73.9625|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:22:00|40.7345|-73.9775|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:22:00|40.7605|-73.9706|B02617|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:21:00| 40.765|-73.9673|B02682|  0|40.7564201526695|-73.98253669425347|\n|0_922337050559328...|2014-08-06 05:21:00|40.7572|-73.9609|B02617|  0|40.7564201526695|-73.98253669425347|\n+--------------------+-------------------+-------+--------+------+---+----------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1531437768285_-253130528","id":"20180702-172401_80528406","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30646"},{"title":"Which hours have the highest pickups for cluster id 0 ? ","text":" z.show( df.filter($\"_id\" <= \"1\")\n  .select(hour($\"dt\").alias(\"hour\"), $\"cid\")\n  .groupBy(\"hour\",\"cid\").agg(count(\"cid\")\n  .alias(\"count\")).orderBy(desc( \"count\")))","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"hour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour\tcid\tcount\n17\t0\t3701\n16\t0\t3653\n18\t0\t3358\n15\t0\t2991\n19\t0\t2882\n20\t0\t2649\n21\t0\t2490\n14\t0\t2291\n22\t0\t2060\n13\t0\t1950\n11\t0\t1700\n12\t0\t1684\n8\t0\t1584\n10\t0\t1566\n9\t0\t1420\n7\t0\t1404\n23\t0\t1390\n0\t0\t937\n6\t0\t896\n1\t0\t634\n5\t0\t622\n3\t0\t535\n4\t0\t494\n2\t0\t410\n"}]},"apps":[],"jobName":"paragraph_1531437768285_-253130528","id":"20180712-135021_1851080599","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30647"},{"text":"  df.filter($\"_id\" <= \"1\").select(hour($\"dt\").alias(\"hour\"), $\"cid\").groupBy(\"hour\").count().orderBy(desc( \"count\")).show","dateUpdated":"2018-07-12T16:22:48-0700","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+\n|hour|count|\n+----+-----+\n|  17| 3701|\n|  16| 3653|\n|  18| 3358|\n|  15| 2991|\n|  19| 2882|\n|  20| 2649|\n|  21| 2490|\n|  14| 2291|\n|  22| 2060|\n|  13| 1950|\n|  11| 1700|\n|  12| 1684|\n|   8| 1584|\n|  10| 1566|\n|   9| 1420|\n|   7| 1404|\n|  23| 1390|\n|   0|  937|\n|   6|  896|\n|   1|  634|\n+----+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1531437768285_-253130528","id":"20180712-140249_1637079837","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30648"},{"title":"Show the first 20 rows","text":"%sql select _id,  dt, cid,  lat, lon from uber order by dt desc limit 10 ","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_id\tdt\tcid\tlat\tlon\n0_9223370505597148248\t2014-08-03 15:18:00.0\t0\t40.7441\t-73.9884\n0_9223370505597148368\t2014-08-03 15:18:00.0\t0\t40.7617\t-73.9778\n0_9223370505597148549\t2014-08-03 15:18:00.0\t0\t40.7638\t-73.9734\n3_9223370505597147887\t2014-08-03 15:18:00.0\t3\t40.7167\t-73.9978\n3_9223370505597148308\t2014-08-03 15:18:00.0\t3\t40.734\t-73.9811\n3_9223370505597148489\t2014-08-03 15:18:00.0\t3\t40.7159\t-74.011\n4_9223370505597147826\t2014-08-03 15:18:00.0\t4\t40.755\t-73.8447\n4_9223370505597148127\t2014-08-03 15:18:00.0\t4\t40.7579\t-73.8446\n4_9223370505597148188\t2014-08-03 15:18:00.0\t4\t40.7579\t-73.8446\n5_9223370505597148007\t2014-08-03 15:18:00.0\t5\t40.6704\t-73.9504\n"}]},"apps":[],"jobName":"paragraph_1531437768285_-253130528","id":"20180614-164709_1965419894","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30649"},{"title":"Print the Dataframe Schema","text":"df.printSchema\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _id: string (nullable = true)\n |-- dt: timestamp (nullable = true)\n |-- lat: double (nullable = true)\n |-- lon: double (nullable = true)\n |-- base: string (nullable = true)\n |-- cid: integer (nullable = true)\n |-- clat: double (nullable = true)\n |-- clon: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1531437768285_-253130528","id":"20161030-030707_2084899217","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30650"},{"title":"Which cluster locations have the highest number of pickups?","text":"df.groupBy(\"cid\").count().orderBy(desc( \"count\")).show","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n|cid|count|\n+---+-----+\n|  3|43544|\n|  0|43301|\n|  9|15182|\n|  6| 8411|\n|  7| 8324|\n|  4| 5210|\n|  2| 4576|\n|  5| 4297|\n|  8| 1963|\n|  1| 1154|\n+---+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1531437768286_-251976282","id":"20180703-135913_1385852518","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30651"},{"title":"Which hours and cluster locations have the highest number of pickups?","text":"df.select(hour($\"dt\").alias(\"hour\"), $\"cid\")\n.groupBy(\"hour\",\"cid\").agg(count(\"cid\")\n.alias(\"count\")).orderBy(desc( \"count\")).show\n\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---+-----+\n|hour|cid|count|\n+----+---+-----+\n|  16|  0| 1432|\n|  18|  0| 1344|\n|  17|  3| 1343|\n|  17|  0| 1306|\n|  18|  3| 1303|\n|  19|  3| 1273|\n|  15|  0| 1235|\n|  19|  0| 1193|\n|  16|  3| 1122|\n|  15|  3| 1098|\n|  14|  0|  931|\n|  14|  3|  916|\n|  20|  3|  893|\n|  20|  0|  853|\n|  22|  3|  838|\n|   0|  3|  779|\n|  23|  3|  759|\n|  13|  0|  752|\n|  13|  3|  745|\n|  12|  0|  691|\n+----+---+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1531437768286_-251976282","id":"20180615-130447_1231472694","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30652"},{"title":"Which day, and hour have the highest number of pickups?","text":"z.show(df.select( dayofmonth($\"dt\").alias(\"day\"), hour($\"dt\").alias(\"hour\"), $\"cid\").groupBy( \"day\", \"hour\", \"cid\").agg(count(\"cid\").alias(\"count\")).orderBy(desc( \"count\")))","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{},"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"hour","index":1,"aggr":"sum"}],"groups":[{"name":"cid","index":2,"aggr":"sum"}],"values":[{"name":"count","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\thour\tcid\tcount\n5\t17\t0\t1031\n1\t16\t0\t948\n5\t16\t0\t934\n4\t17\t0\t889\n5\t18\t0\t874\n1\t17\t0\t849\n2\t22\t3\t840\n1\t22\t3\t838\n1\t18\t0\t788\n1\t17\t3\t788\n1\t15\t0\t784\n4\t16\t0\t781\n5\t19\t0\t765\n1\t23\t3\t759\n4\t18\t0\t753\n5\t15\t0\t739\n1\t18\t3\t727\n5\t20\t3\t713\n1\t19\t0\t700\n3\t0\t3\t693\n1\t19\t3\t686\n2\t23\t3\t685\n5\t20\t0\t679\n5\t17\t3\t668\n1\t22\t0\t661\n2\t21\t3\t656\n5\t18\t3\t655\n1\t21\t0\t642\n5\t21\t3\t641\n1\t16\t3\t639\n1\t21\t3\t635\n1\t20\t3\t635\n2\t0\t3\t626\n5\t19\t3\t621\n1\t20\t0\t611\n4\t15\t0\t607\n4\t19\t0\t604\n1\t15\t3\t599\n5\t14\t0\t596\n2\t19\t3\t587\n5\t16\t3\t587\n1\t14\t0\t580\n4\t20\t0\t579\n5\t21\t0\t577\n2\t18\t3\t576\n2\t20\t3\t575\n2\t18\t0\t556\n2\t17\t3\t555\n3\t1\t3\t546\n2\t1\t3\t540\n1\t14\t3\t524\n2\t21\t0\t520\n4\t18\t3\t514\n5\t15\t3\t514\n3\t16\t0\t506\n4\t19\t3\t502\n4\t17\t3\t501\n2\t15\t3\t499\n2\t22\t0\t498\n2\t19\t0\t493\n4\t20\t3\t493\n4\t16\t3\t489\n2\t16\t0\t484\n2\t16\t3\t483\n1\t13\t0\t476\n3\t17\t0\t475\n5\t13\t0\t474\n4\t21\t0\t470\n2\t20\t0\t457\n2\t17\t0\t457\n4\t14\t0\t456\n5\t14\t3\t456\n2\t15\t0\t451\n5\t22\t3\t451\n4\t7\t3\t444\n1\t8\t3\t440\n2\t23\t0\t434\n5\t8\t0\t433\n5\t7\t3\t432\n3\t16\t3\t424\n4\t13\t0\t422\n5\t7\t0\t418\n3\t17\t3\t412\n5\t8\t3\t412\n1\t13\t3\t412\n3\t15\t0\t410\n4\t8\t0\t409\n1\t7\t3\t409\n5\t11\t0\t407\n4\t15\t3\t406\n5\t22\t0\t401\n3\t15\t3\t400\n1\t12\t0\t396\n1\t23\t0\t394\n5\t12\t0\t393\n1\t8\t0\t392\n2\t14\t3\t392\n4\t21\t3\t390\n3\t18\t0\t387\n5\t10\t0\t379\n1\t11\t0\t377\n4\t8\t3\t374\n3\t18\t3\t373\n1\t10\t0\t370\n1\t9\t0\t370\n4\t7\t0\t364\n3\t14\t3\t363\n4\t14\t3\t361\n3\t2\t3\t354\n2\t14\t0\t351\n1\t7\t0\t347\n5\t13\t3\t346\n1\t9\t3\t346\n5\t9\t0\t344\n4\t11\t0\t343\n1\t10\t3\t337\n2\t13\t3\t333\n3\t19\t3\t330\n2\t2\t3\t328\n3\t20\t3\t327\n5\t9\t3\t326\n3\t20\t0\t323\n3\t21\t3\t323\n1\t11\t3\t322\n3\t11\t0\t322\n3\t19\t0\t320\n3\t12\t3\t317\n5\t10\t3\t316\n4\t12\t0\t312\n4\t10\t0\t311\n5\t12\t3\t309\n4\t6\t3\t308\n3\t14\t0\t308\n5\t6\t3\t305\n3\t13\t3\t305\n4\t9\t0\t304\n3\t13\t0\t302\n2\t12\t3\t302\n1\t12\t3\t301\n5\t11\t3\t301\n3\t0\t0\t298\n4\t22\t0\t297\n2\t12\t0\t295\n4\t22\t3\t293\n3\t12\t0\t288\n2\t11\t3\t285\n5\t7\t9\t283\n4\t7\t9\t282\n3\t11\t3\t282\n3\t21\t0\t281\n1\t6\t3\t280\n2\t13\t0\t276\n4\t9\t3\t276\n4\t13\t3\t276\n5\t8\t9\t273\n3\t10\t0\t269\n4\t10\t3\t266\n4\t11\t3\t265\n3\t10\t3\t259\n2\t18\t9\t257\n4\t6\t0\t253\n4\t8\t9\t251\n2\t11\t0\t251\n1\t7\t9\t250\n2\t0\t0\t248\n4\t12\t3\t243\n2\t10\t0\t237\n5\t23\t3\t234\n5\t6\t0\t233\n1\t8\t9\t230\n2\t3\t3\t230\n2\t10\t3\t230\n3\t3\t3\t226\n2\t9\t3\t223\n3\t1\t0\t221\n5\t23\t0\t221\n1\t18\t9\t219\n1\t19\t9\t216\n3\t9\t0\t216\n2\t17\t9\t215\n5\t6\t9\t213\n4\t23\t0\t211\n2\t19\t9\t206\n2\t21\t9\t203\n1\t6\t0\t203\n3\t22\t0\t203\n2\t16\t9\t202\n1\t20\t9\t198\n1\t17\t9\t197\n3\t22\t3\t197\n4\t6\t9\t197\n2\t8\t0\t195\n2\t8\t3\t195\n2\t15\t9\t191\n3\t9\t3\t189\n4\t5\t3\t187\n5\t5\t3\t187\n2\t9\t0\t186\n2\t22\t7\t186\n5\t18\t9\t185\n1\t15\t9\t185\n2\t20\t9\t183\n2\t22\t9\t183\n2\t1\t0\t181\n1\t16\t9\t179\n1\t21\t9\t179\n4\t23\t3\t179\n2\t21\t7\t177\n1\t23\t7\t176\n5\t17\t9\t173\n1\t22\t9\t170\n2\t23\t7\t168\n5\t16\t9\t167\n3\t16\t9\t167\n2\t18\t7\t166\n4\t17\t9\t166\n3\t8\t3\t165\n5\t9\t9\t163\n1\t6\t9\t162\n4\t18\t9\t161\n3\t11\t9\t159\n5\t20\t9\t159\n2\t19\t7\t158\n3\t12\t9\t157\n2\t18\t6\t157\n3\t0\t7\t157\n3\t8\t0\t155\n2\t16\t6\t155\n4\t9\t9\t154\n2\t17\t6\t154\n1\t0\t3\t153\n3\t10\t9\t153\n1\t13\t9\t152\n2\t4\t3\t152\n2\t22\t6\t152\n2\t20\t7\t152\n2\t14\t9\t151\n5\t19\t9\t150\n2\t20\t6\t150\n5\t14\t9\t149\n2\t19\t6\t148\n3\t17\t9\t147\n4\t5\t0\t147\n1\t14\t9\t147\n2\t16\t7\t147\n2\t7\t3\t146\n2\t7\t0\t146\n3\t3\t0\t146\n5\t21\t6\t145\n3\t2\t0\t145\n2\t23\t6\t144\n1\t10\t9\t144\n3\t14\t9\t144\n2\t12\t9\t143\n2\t13\t9\t142\n4\t16\t9\t142\n5\t21\t9\t142\n1\t21\t6\t141\n3\t23\t3\t141\n5\t11\t9\t141\n4\t19\t9\t140\n5\t15\t9\t140\n1\t9\t9\t139\n2\t3\t0\t139\n5\t5\t0\t138\n3\t18\t9\t138\n2\t17\t7\t138\n6\t0\t3\t138\n1\t22\t7\t136\n2\t0\t7\t136\n4\t21\t9\t135\n3\t15\t9\t134\n2\t15\t6\t133\n3\t19\t9\t132\n3\t7\t3\t132\n4\t20\t9\t132\n3\t23\t0\t130\n4\t10\t9\t129\n2\t11\t9\t129\n3\t13\t9\t129\n1\t5\t3\t129\n3\t7\t0\t129\n1\t19\t4\t128\n5\t10\t9\t128\n1\t22\t6\t128\n1\t23\t6\t128\n2\t6\t3\t127\n2\t23\t9\t127\n1\t21\t7\t127\n2\t21\t6\t126\n3\t22\t2\t126\n1\t17\t6\t124\n4\t15\t9\t124\n2\t10\t9\t124\n3\t0\t6\t123\n1\t11\t9\t123\n3\t20\t2\t123\n3\t16\t6\t123\n4\t14\t9\t123\n3\t14\t6\t121\n4\t11\t9\t121\n1\t18\t6\t120\n5\t12\t9\t120\n2\t9\t9\t120\n1\t20\t6\t120\n1\t12\t9\t119\n1\t0\t0\t119\n2\t2\t0\t119\n2\t15\t7\t118\n4\t13\t9\t117\n1\t1\t3\t117\n2\t8\t9\t117\n4\t12\t9\t116\n2\t14\t6\t116\n5\t22\t9\t115\n2\t6\t0\t114\n1\t19\t7\t113\n1\t5\t0\t112\n3\t20\t9\t112\n1\t18\t7\t112\n1\t23\t9\t111\n6\t4\t3\t110\n2\t5\t3\t109\n5\t4\t3\t109\n3\t4\t3\t108\n3\t21\t2\t108\n6\t0\t0\t108\n3\t20\t4\t106\n5\t5\t9\t106\n1\t21\t4\t106\n3\t15\t4\t106\n1\t20\t4\t105\n4\t14\t2\t105\n3\t17\t6\t104\n4\t4\t3\t104\n3\t18\t6\t102\n5\t13\t9\t102\n1\t19\t6\t101\n5\t0\t3\t101\n6\t4\t0\t100\n3\t9\t9\t98\n4\t10\t4\t98\n3\t17\t2\t97\n2\t14\t7\t97\n3\t0\t9\t96\n4\t4\t0\t95\n3\t19\t2\t95\n3\t1\t7\t94\n3\t23\t2\t94\n4\t5\t9\t94\n1\t16\t6\t94\n3\t17\t7\t94\n1\t13\t6\t94\n2\t7\t9\t94\n1\t4\t0\t94\n3\t15\t6\t93\n3\t6\t0\t93\n1\t20\t7\t93\n3\t14\t7\t92\n3\t17\t4\t92\n5\t20\t6\t92\n3\t19\t7\t91\n1\t7\t6\t91\n3\t5\t3\t91\n5\t19\t6\t90\n1\t5\t9\t90\n4\t3\t3\t89\n5\t0\t0\t89\n2\t12\t6\t89\n3\t16\t4\t89\n6\t5\t3\t89\n3\t10\t6\t89\n2\t4\t0\t87\n5\t22\t6\t87\n4\t6\t2\t87\n2\t13\t7\t87\n2\t20\t5\t86\n1\t17\t7\t86\n3\t6\t3\t86\n3\t11\t6\t86\n4\t7\t6\t85\n5\t18\t6\t85\n6\t3\t3\t84\n2\t13\t6\t84\n3\t20\t6\t84\n2\t20\t4\t84\n3\t19\t4\t83\n3\t12\t6\t83\n1\t3\t3\t83\n1\t22\t4\t83\n3\t13\t6\t83\n2\t23\t5\t83\n1\t2\t3\t82\n3\t5\t0\t82\n1\t1\t0\t82\n3\t15\t7\t82\n5\t7\t6\t81\n3\t21\t9\t81\n3\t11\t7\t80\n4\t8\t4\t80\n3\t19\t6\t80\n3\t14\t4\t80\n4\t19\t4\t80\n2\t5\t0\t79\n4\t22\t9\t79\n3\t21\t4\t79\n4\t18\t6\t79\n1\t16\t7\t79\n1\t13\t7\t79\n1\t7\t7\t78\n2\t1\t7\t78\n5\t17\t6\t78\n5\t22\t7\t78\n1\t9\t7\t77\n1\t4\t3\t77\n3\t12\t7\t77\n4\t17\t6\t77\n2\t0\t9\t77\n4\t6\t7\t77\n1\t14\t6\t77\n3\t16\t7\t76\n5\t14\t2\t76\n5\t8\t6\t76\n3\t15\t2\t76\n6\t3\t0\t76\n3\t13\t7\t76\n3\t22\t4\t75\n5\t18\t7\t75\n1\t8\t7\t75\n5\t20\t4\t75\n5\t17\t7\t75\n1\t18\t4\t75\n4\t0\t0\t75\n3\t1\t9\t75\n1\t6\t6\t74\n1\t15\t7\t74\n1\t6\t7\t74\n2\t9\t6\t74\n3\t13\t4\t74\n4\t6\t6\t74\n5\t9\t4\t74\n2\t16\t4\t74\n4\t4\t9\t73\n4\t5\t2\t73\n1\t15\t6\t73\n3\t0\t5\t73\n3\t18\t4\t73\n3\t2\t7\t73\n3\t21\t6\t72\n3\t18\t7\t72\n4\t9\t4\t72\n2\t10\t6\t72\n2\t11\t6\t72\n2\t19\t5\t72\n3\t20\t7\t71\n3\t14\t2\t71\n3\t21\t7\t71\n6\t1\t3\t71\n5\t23\t9\t71\n4\t0\t3\t70\n2\t0\t6\t70\n4\t8\t6\t70\n1\t9\t6\t70\n2\t18\t5\t70\n3\t10\t7\t69\n1\t23\t5\t69\n5\t20\t7\t69\n5\t6\t6\t69\n4\t17\t7\t68\n2\t6\t9\t68\n5\t21\t7\t68\n4\t7\t7\t68\n2\t2\t7\t68\n4\t18\t2\t68\n2\t22\t5\t67\n3\t8\t9\t67\n3\t16\t2\t67\n4\t15\t4\t67\n1\t3\t0\t67\n1\t22\t5\t67\n4\t13\t6\t67\n2\t14\t5\t66\n4\t18\t7\t66\n6\t4\t9\t65\n4\t20\t6\t65\n5\t23\t7\t65\n3\t22\t9\t65\n5\t19\t7\t65\n5\t9\t6\t65\n5\t16\t6\t64\n1\t12\t6\t64\n4\t7\t4\t64\n4\t9\t6\t64\n6\t5\t0\t64\n1\t19\t2\t64\n4\t19\t7\t63\n5\t11\t6\t63\n4\t19\t6\t63\n2\t21\t5\t62\n6\t1\t0\t62\n3\t9\t7\t62\n4\t21\t7\t62\n3\t12\t4\t62\n1\t8\t6\t62\n2\t21\t4\t62\n1\t14\t4\t61\n4\t12\t7\t61\n4\t3\t0\t61\n1\t0\t7\t61\n5\t10\t6\t61\n4\t11\t4\t60\n2\t9\t7\t60\n5\t17\t4\t60\n2\t14\t2\t60\n4\t9\t7\t60\n4\t8\t7\t60\n4\t20\t7\t60\n3\t13\t2\t60\n4\t16\t2\t60\n4\t16\t6\t60\n2\t5\t9\t60\n2\t0\t5\t59\n4\t21\t4\t59\n4\t14\t6\t59\n1\t10\t7\t59\n5\t3\t3\t59\n1\t9\t4\t59\n4\t21\t6\t59\n1\t14\t2\t59\n1\t14\t7\t59\n5\t12\t6\t59\n5\t4\t0\t59\n5\t12\t7\t59\n2\t11\t7\t59\n3\t4\t0\t59\n4\t15\t6\t58\n5\t8\t7\t58\n5\t6\t7\t58\n2\t10\t7\t58\n2\t17\t4\t58\n5\t16\t7\t58\n3\t9\t6\t58\n1\t21\t5\t58\n5\t15\t6\t57\n4\t5\t7\t57\n4\t12\t6\t57\n4\t13\t4\t57\n1\t10\t6\t57\n4\t16\t7\t57\n2\t15\t4\t57\n5\t19\t4\t57\n1\t22\t2\t57\n5\t15\t7\t57\n3\t1\t6\t57\n1\t2\t0\t56\n1\t18\t2\t56\n4\t3\t9\t56\n2\t1\t9\t56\n4\t20\t2\t56\n1\t20\t5\t56\n5\t5\t6\t55\n5\t8\t4\t55\n2\t8\t7\t55\n5\t4\t9\t55\n5\t14\t6\t55\n1\t11\t7\t55\n2\t14\t4\t54\n2\t16\t5\t54\n2\t17\t5\t54\n6\t2\t3\t54\n4\t22\t7\t54\n1\t4\t9\t54\n4\t11\t6\t54\n2\t8\t6\t54\n2\t12\t7\t54\n2\t10\t4\t53\n6\t5\t9\t53\n3\t22\t6\t53\n4\t1\t3\t53\n2\t19\t2\t53\n4\t14\t4\t53\n5\t7\t7\t52\n1\t20\t2\t52\n5\t14\t4\t52\n5\t7\t4\t52\n4\t10\t6\t52\n4\t22\t2\t52\n4\t11\t7\t52\n3\t3\t9\t52\n2\t21\t2\t52\n5\t20\t2\t52\n5\t15\t4\t51\n4\t13\t2\t51\n4\t17\t2\t51\n4\t15\t2\t51\n1\t11\t6\t51\n2\t18\t4\t51\n3\t17\t5\t50\n4\t20\t4\t50\n1\t12\t7\t50\n2\t11\t5\t50\n2\t13\t4\t50\n1\t11\t4\t49\n5\t13\t4\t49\n3\t11\t5\t49\n2\t12\t5\t49\n5\t18\t4\t49\n5\t13\t6\t49\n1\t17\t2\t49\n5\t14\t7\t49\n5\t1\t0\t49\n4\t23\t9\t49\n1\t23\t2\t49\n3\t7\t7\t49\n2\t4\t9\t48\n2\t15\t5\t48\n1\t16\t2\t48\n3\t11\t4\t48\n4\t7\t2\t48\n3\t12\t5\t48\n3\t1\t5\t48\n4\t19\t2\t48\n3\t18\t2\t48\n5\t13\t7\t47\n4\t21\t2\t47\n2\t9\t5\t47\n5\t11\t4\t47\n5\t1\t3\t47\n5\t2\t3\t47\n2\t15\t2\t47\n5\t9\t7\t47\n3\t7\t9\t47\n4\t22\t6\t47\n5\t21\t2\t47\n4\t17\t4\t47\n5\t3\t0\t46\n5\t21\t4\t46\n3\t10\t5\t46\n1\t23\t4\t46\n4\t14\t7\t46\n2\t1\t5\t46\n6\t2\t0\t46\n1\t0\t9\t46\n5\t23\t6\t46\n1\t15\t4\t45\n1\t21\t2\t45\n3\t13\t5\t45\n4\t16\t4\t45\n4\t12\t4\t45\n3\t6\t9\t45\n2\t22\t2\t45\n1\t6\t5\t45\n1\t15\t2\t45\n2\t11\t4\t44\n4\t5\t6\t44\n5\t15\t2\t44\n5\t10\t7\t44\n5\t11\t7\t44\n2\t7\t7\t44\n1\t5\t2\t44\n4\t6\t4\t44\n2\t3\t7\t44\n5\t5\t7\t44\n3\t3\t7\t44\n3\t23\t9\t44\n1\t19\t5\t44\n3\t10\t4\t44\n5\t7\t5\t43\n3\t18\t5\t43\n2\t3\t9\t43\n5\t18\t2\t43\n4\t2\t3\t43\n3\t22\t7\t43\n4\t23\t2\t43\n1\t10\t4\t43\n1\t13\t4\t43\n5\t10\t4\t42\n1\t17\t5\t42\n2\t16\t2\t42\n4\t18\t4\t42\n2\t12\t4\t42\n1\t16\t4\t42\n4\t10\t7\t42\n4\t13\t7\t42\n1\t18\t5\t42\n3\t14\t5\t41\n4\t22\t4\t41\n1\t13\t2\t41\n2\t4\t7\t41\n2\t20\t2\t41\n5\t16\t4\t41\n2\t22\t4\t40\n1\t3\t9\t40\n3\t16\t5\t40\n2\t5\t2\t40\n5\t19\t2\t40\n2\t13\t2\t40\n2\t13\t5\t39\n3\t21\t5\t39\n6\t4\t7\t39\n3\t8\t6\t39\n2\t1\t6\t39\n1\t12\t4\t39\n3\t2\t9\t39\n1\t6\t2\t39\n4\t1\t0\t39\n1\t10\t5\t39\n2\t17\t8\t39\n4\t17\t5\t39\n5\t23\t2\t39\n3\t9\t4\t38\n4\t6\t5\t38\n6\t0\t9\t38\n3\t4\t9\t38\n2\t15\t8\t38\n3\t2\t5\t38\n3\t23\t6\t38\n1\t7\t5\t38\n2\t0\t2\t38\n4\t18\t5\t38\n2\t14\t8\t37\n1\t13\t5\t37\n3\t20\t8\t37\n2\t3\t6\t37\n2\t22\t8\t37\n1\t17\t4\t37\n5\t16\t2\t37\n1\t12\t2\t36\n3\t8\t7\t36\n1\t5\t6\t36\n2\t19\t8\t36\n1\t9\t5\t36\n5\t22\t2\t36\n3\t2\t6\t36\n1\t16\t5\t36\n2\t2\t9\t35\n4\t20\t5\t35\n2\t9\t4\t35\n3\t5\t9\t35\n5\t6\t5\t35\n1\t15\t5\t35\n2\t19\t4\t35\n1\t22\t8\t35\n2\t5\t5\t35\n2\t23\t4\t35\n5\t3\t9\t35\n4\t19\t5\t35\n1\t0\t6\t35\n1\t5\t7\t35\n3\t19\t5\t35\n2\t10\t5\t35\n3\t23\t7\t34\n3\t22\t5\t34\n3\t16\t1\t34\n5\t17\t2\t34\n5\t20\t5\t34\n1\t7\t4\t34\n4\t23\t7\t34\n4\t15\t7\t34\n3\t8\t5\t34\n1\t12\t5\t33\n3\t20\t5\t33\n4\t0\t2\t33\n4\t4\t7\t33\n3\t3\t5\t33\n1\t8\t4\t33\n3\t5\t5\t33\n5\t11\t5\t32\n1\t8\t5\t32\n5\t13\t2\t32\n3\t5\t7\t32\n4\t22\t5\t32\n1\t21\t8\t32\n5\t11\t2\t32\n4\t5\t5\t32\n2\t6\t7\t32\n5\t21\t5\t32\n5\t9\t5\t32\n5\t12\t2\t32\n4\t4\t6\t32\n1\t14\t5\t31\n6\t0\t7\t31\n4\t0\t9\t31\n5\t12\t4\t31\n1\t1\t7\t31\n2\t18\t2\t31\n2\t8\t4\t31\n5\t17\t5\t31\n1\t4\t7\t31\n4\t10\t2\t31\n5\t22\t4\t30\n2\t7\t6\t30\n3\t12\t2\t30\n4\t21\t5\t30\n1\t11\t5\t30\n3\t15\t5\t30\n6\t3\t9\t30\n3\t11\t2\t30\n3\t7\t6\t30\n3\t9\t5\t30\n2\t23\t2\t30\n5\t19\t5\t29\n4\t23\t6\t29\n3\t7\t2\t29\n2\t2\t5\t29\n3\t13\t8\t29\n5\t15\t5\t29\n3\t4\t7\t29\n2\t21\t8\t29\n4\t15\t5\t29\n5\t18\t5\t29\n2\t12\t8\t28\n4\t14\t5\t28\n5\t4\t6\t28\n5\t22\t5\t28\n4\t9\t5\t28\n5\t5\t2\t28\n4\t8\t5\t28\n5\t8\t5\t28\n2\t2\t6\t28\n2\t17\t2\t28\n5\t12\t5\t28\n2\t6\t6\t28\n6\t4\t6\t28\n2\t6\t5\t28\n5\t2\t0\t28\n1\t0\t5\t28\n1\t2\t9\t28\n5\t6\t4\t27\n3\t4\t5\t27\n2\t5\t7\t27\n5\t13\t5\t27\n4\t7\t5\t27\n2\t5\t6\t27\n5\t6\t2\t27\n2\t6\t2\t27\n6\t3\t7\t27\n6\t4\t2\t27\n2\t20\t8\t26\n5\t5\t5\t26\n1\t19\t8\t26\n3\t6\t7\t26\n4\t8\t2\t26\n2\t7\t5\t26\n3\t14\t8\t25\n3\t0\t8\t25\n1\t3\t7\t25\n2\t18\t8\t25\n2\t13\t8\t25\n3\t3\t6\t25\n4\t10\t5\t25\n1\t4\t2\t25\n4\t3\t6\t25\n4\t0\t7\t25\n5\t16\t8\t25\n2\t11\t2\t24\n3\t23\t5\t24\n3\t19\t8\t24\n3\t18\t8\t24\n5\t10\t5\t24\n4\t12\t2\t24\n6\t2\t9\t23\n4\t11\t5\t23\n5\t7\t2\t23\n3\t17\t8\t23\n1\t7\t2\t23\n3\t6\t5\t23\n5\t22\t8\t23\n1\t8\t2\t23\n4\t5\t4\t23\n4\t13\t5\t23\n4\t22\t1\t23\n5\t7\t8\t23\n4\t22\t8\t22\n5\t4\t7\t22\n1\t23\t8\t22\n1\t1\t9\t22\n5\t0\t5\t22\n4\t23\t5\t22\n5\t23\t5\t22\n5\t4\t5\t22\n3\t11\t8\t22\n3\t10\t2\t22\n6\t4\t5\t22\n4\t12\t5\t22\n2\t7\t4\t22\n3\t8\t4\t22\n2\t23\t8\t22\n4\t4\t2\t22\n3\t5\t6\t22\n1\t2\t7\t21\n4\t20\t1\t21\n4\t11\t2\t21\n4\t3\t7\t21\n3\t20\t1\t21\n5\t21\t8\t21\n4\t4\t5\t21\n3\t18\t1\t21\n1\t13\t8\t21\n5\t0\t9\t21\n3\t19\t1\t21\n3\t17\t1\t21\n1\t8\t8\t21\n3\t6\t6\t21\n4\t1\t7\t21\n5\t4\t2\t21\n4\t16\t8\t21\n5\t0\t6\t21\n6\t0\t2\t20\n2\t0\t4\t20\n5\t3\t6\t20\n6\t1\t7\t20\n2\t12\t2\t20\n4\t0\t6\t20\n5\t19\t8\t20\n5\t6\t8\t20\n5\t14\t5\t20\n2\t16\t8\t20\n4\t9\t2\t20\n2\t3\t5\t20\n5\t17\t8\t20\n3\t22\t1\t20\n5\t5\t4\t20\n6\t5\t6\t20\n1\t17\t8\t20\n5\t16\t5\t20\n6\t5\t7\t20\n3\t23\t4\t20\n3\t16\t8\t20\n1\t1\t5\t20\n4\t3\t5\t20\n4\t16\t5\t19\n4\t21\t8\t19\n5\t0\t7\t19\n3\t13\t1\t19\n1\t4\t5\t19\n5\t8\t8\t19\n5\t9\t2\t19\n6\t5\t2\t19\n1\t6\t4\t19\n5\t11\t8\t19\n1\t9\t8\t19\n4\t1\t9\t19\n5\t1\t9\t19\n1\t11\t8\t19\n4\t0\t5\t19\n5\t23\t4\t19\n3\t4\t6\t19\n2\t7\t2\t19\n4\t18\t1\t19\n3\t0\t4\t19\n3\t21\t1\t19\n4\t10\t8\t19\n5\t3\t7\t19\n3\t0\t2\t19\n5\t8\t2\t18\n1\t1\t6\t18\n5\t10\t2\t18\n1\t18\t8\t18\n1\t11\t2\t18\n2\t9\t2\t18\n1\t3\t6\t18\n3\t11\t1\t18\n3\t10\t8\t18\n4\t15\t1\t18\n1\t17\t1\t18\n5\t20\t1\t18\n5\t1\t7\t18\n4\t13\t8\t18\n1\t7\t8\t18\n3\t15\t8\t18\n4\t5\t1\t18\n1\t13\t1\t18\n3\t21\t8\t17\n2\t8\t8\t17\n4\t4\t1\t17\n2\t8\t5\t17\n4\t11\t8\t17\n2\t10\t8\t17\n5\t2\t7\t17\n4\t8\t8\t17\n1\t3\t5\t17\n1\t9\t2\t17\n2\t4\t6\t17\n3\t7\t5\t17\n2\t4\t2\t17\n1\t20\t8\t17\n4\t23\t1\t17\n4\t19\t1\t17\n6\t3\t5\t16\n3\t5\t2\t16\n4\t16\t1\t16\n1\t16\t8\t16\n6\t2\t5\t16\n5\t1\t2\t16\n4\t17\t1\t16\n1\t10\t2\t16\n1\t5\t5\t16\n3\t1\t4\t16\n4\t14\t1\t16\n3\t22\t8\t16\n5\t3\t5\t16\n6\t1\t9\t16\n6\t2\t7\t16\n1\t22\t1\t16\n2\t4\t5\t16\n2\t20\t1\t16\n1\t14\t8\t16\n4\t2\t0\t16\n1\t10\t8\t16\n2\t6\t4\t15\n6\t0\t6\t15\n2\t11\t8\t15\n4\t23\t8\t15\n1\t4\t6\t15\n4\t2\t7\t15\n5\t16\t1\t15\n3\t12\t8\t15\n2\t9\t8\t15\n3\t15\t1\t15\n4\t8\t1\t15\n4\t20\t8\t15\n5\t2\t9\t15\n2\t5\t4\t15\n1\t19\t1\t15\n4\t13\t1\t14\n2\t10\t2\t14\n1\t5\t4\t14\n4\t4\t4\t14\n1\t18\t1\t14\n4\t17\t8\t14\n5\t15\t1\t14\n5\t10\t8\t14\n5\t8\t1\t14\n1\t2\t5\t14\n1\t16\t1\t14\n2\t8\t2\t14\n1\t21\t1\t14\n4\t9\t8\t14\n4\t0\t1\t13\n4\t9\t1\t13\n1\t6\t8\t13\n4\t15\t8\t13\n4\t6\t8\t13\n3\t9\t2\t13\n4\t12\t1\t13\n4\t14\t8\t13\n3\t23\t1\t13\n3\t23\t8\t13\n5\t5\t8\t13\n2\t6\t8\t13\n3\t2\t8\t13\n2\t1\t2\t13\n5\t20\t8\t13\n2\t5\t1\t13\n2\t4\t4\t13\n4\t2\t9\t13\n5\t1\t6\t13\n3\t1\t8\t12\n3\t1\t2\t12\n3\t2\t4\t12\n6\t0\t5\t12\n3\t4\t2\t12\n2\t0\t8\t12\n5\t13\t1\t12\n3\t7\t4\t12\n6\t5\t5\t12\n2\t1\t4\t12\n1\t23\t1\t12\n5\t4\t4\t12\n5\t12\t8\t12\n6\t3\t6\t12\n3\t14\t1\t12\n1\t0\t2\t11\n4\t21\t1\t11\n2\t12\t1\t11\n6\t1\t5\t11\n1\t1\t8\t11\n1\t12\t8\t11\n5\t22\t1\t11\n5\t9\t8\t11\n4\t10\t1\t11\n4\t7\t8\t11\n1\t0\t4\t11\n4\t23\t4\t11\n3\t8\t2\t11\n1\t2\t6\t11\n5\t14\t8\t11\n1\t11\t1\t11\n1\t15\t8\t11\n3\t8\t8\t11\n5\t23\t1\t11\n5\t2\t5\t11\n2\t19\t1\t11\n1\t5\t8\t10\n4\t2\t6\t10\n3\t9\t8\t10\n3\t3\t2\t10\n4\t1\t6\t10\n3\t12\t1\t10\n2\t7\t8\t10\n1\t4\t4\t10\n5\t0\t8\t10\n4\t2\t2\t10\n5\t13\t8\t10\n5\t17\t1\t9\n2\t1\t8\t9\n2\t2\t4\t9\n5\t15\t8\t9\n2\t14\t1\t9\n5\t3\t4\t9\n2\t15\t1\t9\n4\t18\t8\t9\n5\t18\t8\t9\n2\t16\t1\t9\n5\t18\t1\t9\n5\t1\t5\t9\n3\t6\t4\t9\n1\t15\t1\t9\n4\t19\t8\t9\n4\t12\t8\t9\n6\t0\t1\t9\n4\t3\t4\t9\n2\t17\t1\t9\n6\t1\t6\t8\n6\t3\t8\t8\n2\t2\t2\t8\n5\t4\t8\t8\n3\t3\t8\t8\n5\t12\t1\t8\n1\t12\t1\t8\n4\t11\t1\t8\n6\t1\t4\t8\n2\t5\t8\t8\n3\t6\t2\t8\n4\t3\t8\t8\n3\t6\t8\t8\n4\t5\t8\t8\n4\t6\t1\t8\n4\t0\t8\t8\n4\t7\t1\t8\n3\t4\t8\t8\n3\t2\t2\t8\n5\t4\t1\t8\n5\t14\t1\t7\n1\t20\t1\t7\n1\t6\t1\t7\n3\t7\t8\t7\n2\t7\t1\t7\n5\t0\t2\t7\n4\t3\t2\t7\n1\t4\t8\t7\n3\t3\t4\t7\n2\t3\t8\t7\n2\t0\t1\t7\n2\t8\t1\t7\n2\t4\t8\t7\n1\t1\t4\t7\n1\t8\t1\t7\n2\t6\t1\t7\n4\t2\t5\t7\n2\t23\t1\t7\n6\t2\t4\t7\n6\t4\t8\t6\n6\t1\t8\t6\n1\t4\t1\t6\n4\t0\t4\t6\n3\t10\t1\t6\n5\t2\t6\t6\n5\t21\t1\t6\n5\t7\t1\t6\n4\t4\t8\t6\n1\t2\t8\t6\n1\t0\t8\t6\n5\t11\t1\t6\n6\t4\t4\t6\n2\t2\t8\t6\n1\t14\t1\t6\n5\t19\t1\t6\n5\t0\t4\t6\n4\t1\t4\t6\n5\t6\t1\t5\n5\t3\t8\t5\n1\t1\t1\t5\n1\t2\t4\t5\n2\t3\t4\t5\n3\t5\t4\t5\n3\t5\t8\t5\n2\t13\t1\t5\n6\t5\t4\t5\n3\t5\t1\t5\n5\t0\t1\t5\n6\t3\t4\t5\n1\t10\t1\t5\n5\t10\t1\t5\n4\t1\t8\t5\n2\t10\t1\t5\n5\t5\t1\t5\n6\t2\t2\t5\n3\t9\t1\t5\n5\t23\t8\t4\n3\t4\t4\t4\n6\t0\t4\t4\n6\t5\t8\t4\n6\t2\t6\t4\n2\t11\t1\t4\n1\t7\t1\t4\n4\t3\t1\t4\n4\t2\t4\t4\n5\t1\t4\t4\n3\t7\t1\t4\n1\t3\t8\t4\n4\t1\t2\t4\n5\t9\t1\t4\n6\t2\t8\t4\n2\t1\t1\t4\n4\t1\t5\t4\n1\t1\t2\t4\n6\t3\t2\t4\n2\t3\t2\t4\n1\t3\t4\t3\n1\t9\t1\t3\n2\t9\t1\t3\n5\t2\t8\t3\n2\t4\t1\t3\n5\t2\t2\t3\n2\t22\t1\t3\n6\t1\t2\t3\n1\t0\t1\t3\n2\t18\t1\t3\n3\t8\t1\t3\n4\t2\t8\t3\n5\t1\t8\t3\n2\t21\t1\t3\n6\t0\t8\t3\n1\t3\t2\t2\n6\t5\t1\t2\n3\t4\t1\t2\n3\t1\t1\t2\n2\t2\t1\t2\n3\t0\t1\t2\n1\t5\t1\t2\n6\t1\t1\t2\n5\t2\t4\t2\n1\t2\t2\t2\n3\t6\t1\t1\n6\t4\t1\t1\n6\t3\t1\t1\n3\t2\t1\t1\n6\t2\t1\t1\n1\t2\t1\t1\n4\t1\t1\t1\n5\t3\t2\t1\n"}]},"apps":[],"jobName":"paragraph_1531437768286_-251976282","id":"20180703-142816_188810109","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30653"},{"title":"Which hours and clusters have the highest number of pickups?","text":"z.show(df.select(hour($\"dt\").alias(\"hour\"), $\"cid\")\n.groupBy(\"hour\",\"cid\").agg(count(\"cid\")\n.alias(\"count\")).orderBy(desc( \"count\")))","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"hour","index":0,"aggr":"sum"}],"groups":[{"name":"cid","index":1,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour\tcid\tcount\n16\t0\t1432\n18\t0\t1344\n17\t3\t1343\n17\t0\t1306\n18\t3\t1303\n19\t3\t1273\n15\t0\t1235\n19\t0\t1193\n16\t3\t1122\n15\t3\t1098\n14\t0\t931\n14\t3\t916\n20\t3\t893\n20\t0\t853\n22\t3\t838\n0\t3\t779\n23\t3\t759\n13\t0\t752\n13\t3\t745\n12\t0\t691\n22\t0\t661\n1\t3\t657\n21\t0\t642\n8\t3\t635\n21\t3\t635\n11\t0\t628\n11\t3\t607\n10\t0\t607\n12\t3\t603\n8\t0\t587\n9\t3\t569\n10\t3\t567\n9\t0\t556\n7\t3\t555\n7\t0\t493\n18\t9\t476\n19\t9\t422\n17\t9\t412\n2\t3\t410\n6\t3\t407\n23\t0\t394\n16\t9\t381\n15\t9\t376\n0\t0\t367\n8\t9\t347\n7\t9\t344\n6\t0\t317\n3\t3\t313\n20\t9\t304\n14\t9\t298\n13\t9\t294\n17\t6\t278\n18\t7\t278\n18\t6\t277\n19\t7\t271\n10\t9\t268\n1\t0\t263\n12\t9\t262\n9\t9\t259\n11\t9\t252\n19\t6\t249\n16\t6\t249\n5\t3\t238\n6\t9\t230\n4\t3\t229\n16\t7\t226\n17\t7\t224\n15\t6\t206\n3\t0\t206\n0\t7\t197\n20\t6\t193\n14\t6\t193\n15\t7\t192\n5\t0\t191\n4\t0\t181\n21\t9\t179\n13\t6\t178\n23\t7\t176\n2\t0\t175\n22\t9\t170\n13\t7\t166\n20\t7\t165\n19\t4\t163\n14\t7\t156\n12\t6\t153\n5\t9\t150\n9\t6\t144\n21\t6\t141\n20\t4\t140\n9\t7\t137\n22\t7\t136\n8\t7\t130\n10\t6\t129\n23\t6\t128\n22\t6\t128\n21\t7\t127\n18\t4\t126\n11\t6\t123\n0\t9\t123\n7\t7\t122\n7\t6\t121\n14\t2\t119\n19\t2\t117\n10\t7\t117\n19\t5\t116\n8\t6\t116\n16\t4\t116\n14\t4\t115\n11\t7\t114\n18\t5\t112\n23\t9\t111\n1\t7\t109\n6\t7\t106\n21\t4\t106\n0\t6\t105\n12\t7\t104\n15\t4\t102\n6\t6\t102\n4\t9\t102\n20\t5\t97\n14\t5\t97\n10\t4\t96\n17\t5\t96\n17\t4\t95\n9\t4\t94\n11\t4\t93\n13\t4\t93\n15\t2\t92\n16\t2\t90\n16\t5\t90\n2\t7\t89\n18\t2\t87\n0\t5\t87\n5\t2\t84\n9\t5\t83\n15\t5\t83\n22\t4\t83\n3\t9\t83\n12\t5\t82\n12\t4\t81\n13\t2\t81\n11\t5\t80\n1\t9\t78\n17\t2\t77\n13\t5\t76\n20\t2\t75\n10\t5\t74\n6\t5\t73\n4\t7\t72\n23\t5\t69\n3\t7\t69\n22\t5\t67\n6\t2\t66\n1\t5\t66\n8\t4\t64\n7\t5\t64\n2\t9\t63\n5\t6\t63\n5\t7\t62\n19\t8\t62\n17\t8\t59\n21\t5\t58\n1\t6\t57\n22\t2\t57\n7\t4\t56\n12\t2\t56\n3\t6\t55\n14\t8\t53\n5\t5\t51\n23\t2\t49\n0\t2\t49\n8\t5\t49\n15\t8\t49\n23\t4\t46\n13\t8\t46\n21\t2\t45\n2\t5\t43\n18\t8\t43\n7\t2\t42\n11\t2\t42\n4\t2\t42\n12\t8\t39\n2\t6\t39\n8\t8\t38\n3\t5\t37\n8\t2\t37\n16\t8\t36\n22\t8\t35\n4\t5\t35\n9\t2\t35\n9\t8\t34\n11\t8\t34\n6\t4\t34\n10\t8\t33\n4\t6\t32\n21\t8\t32\n20\t8\t31\n0\t4\t31\n10\t2\t30\n5\t4\t29\n7\t8\t28\n17\t1\t27\n19\t1\t26\n6\t8\t26\n16\t1\t23\n4\t4\t23\n13\t1\t23\n23\t8\t22\n1\t8\t20\n1\t4\t19\n12\t1\t19\n5\t8\t18\n15\t1\t18\n0\t8\t18\n20\t1\t17\n18\t1\t17\n1\t2\t17\n22\t1\t16\n11\t1\t15\n5\t1\t15\n14\t1\t15\n6\t1\t14\n2\t4\t14\n21\t1\t14\n4\t8\t14\n8\t1\t14\n23\t1\t12\n2\t8\t12\n7\t1\t11\n3\t8\t11\n0\t1\t10\n2\t2\t10\n10\t1\t10\n1\t1\t9\n4\t1\t9\n3\t4\t8\n3\t2\t6\n9\t1\t6\n2\t1\t3\n"}]},"apps":[],"jobName":"paragraph_1531437768286_-251976282","id":"20180703-140057_1940479723","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30654"},{"text":"%sql\nSELECT hour(uber.dt) as hr,cid, count(cid) as ct FROM uber group By hour(uber.dt), cid","dateUpdated":"2018-07-12T16:22:48-0700","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"hr","index":0,"aggr":"sum"}],"groups":[{"name":"cid","index":1,"aggr":"sum"}],"values":[{"name":"ct","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tcid\tct\n10\t2\t52\n23\t6\t272\n17\t1\t27\n17\t2\t77\n16\t3\t1122\n1\t0\t484\n6\t1\t15\n17\t3\t1343\n7\t4\t68\n22\t8\t72\n2\t2\t18\n22\t9\t353\n18\t1\t17\n22\t6\t280\n9\t4\t132\n8\t9\t414\n19\t2\t117\n8\t3\t800\n12\t7\t181\n13\t8\t75\n20\t2\t93\n1\t7\t203\n11\t8\t56\n7\t1\t15\n2\t3\t764\n11\t6\t209\n4\t7\t101\n12\t2\t86\n1\t2\t29\n16\t2\t90\n13\t7\t242\n0\t7\t354\n11\t1\t33\n9\t1\t11\n6\t0\t410\n23\t0\t828\n4\t0\t240\n17\t7\t224\n16\t8\t36\n15\t1\t19\n13\t9\t423\n1\t9\t153\n0\t5\t160\n23\t2\t79\n5\t7\t94\n15\t5\t95\n5\t6\t85\n16\t0\t1432\n12\t1\t29\n15\t6\t230\n14\t3\t1279\n6\t8\t34\n16\t4\t116\n10\t5\t120\n1\t1\t11\n6\t5\t96\n9\t7\t199\n4\t9\t140\n1\t3\t1203\n20\t3\t1210\n11\t4\t141\n19\t1\t26\n10\t6\t218\n18\t9\t476\n3\t5\t70\n21\t5\t120\n11\t7\t194\n13\t5\t121\n15\t2\t123\n2\t5\t81\n21\t6\t267\n15\t8\t53\n0\t0\t665\n7\t2\t71\n17\t6\t278\n16\t9\t381\n14\t2\t190\n1\t4\t35\n5\t4\t34\n18\t8\t43\n12\t5\t130\n23\t3\t1444\n21\t3\t1291\n7\t9\t391\n21\t2\t97\n14\t4\t195\n2\t9\t102\n10\t4\t140\n10\t1\t16\n7\t3\t687\n19\t4\t163\n11\t5\t129\n3\t3\t539\n23\t5\t152\n15\t7\t218\n9\t3\t758\n1\t8\t32\n9\t2\t48\n21\t4\t168\n16\t7\t226\n17\t8\t59\n8\t5\t83\n11\t9\t411\n8\t1\t17\n17\t9\t412\n13\t4\t167\n0\t9\t219\n21\t7\t304\n22\t0\t1159\n4\t3\t337\n6\t7\t132\n2\t1\t4\n14\t6\t314\n18\t6\t277\n8\t8\t49\n15\t9\t429\n14\t0\t1239\n2\t4\t26\n11\t3\t889\n18\t5\t112\n21\t0\t1162\n20\t5\t142\n4\t6\t51\n21\t8\t61\n6\t3\t493\n12\t0\t979\n13\t3\t1050\n9\t8\t44\n19\t6\t249\n8\t7\t166\n12\t8\t54\n3\t6\t80\n8\t2\t48\n7\t5\t81\n13\t6\t261\n16\t1\t23\n6\t2\t74\n9\t5\t113\n16\t6\t249\n23\t7\t344\n20\t8\t43\n10\t9\t421\n3\t9\t135\n18\t0\t1344\n12\t4\t143\n19\t7\t271\n11\t0\t950\n2\t0\t320\n0\t1\t12\n21\t1\t17\n17\t4\t95\n18\t2\t87\n5\t8\t23\n14\t9\t442\n20\t0\t1068\n20\t7\t245\n20\t1\t23\n18\t4\t126\n13\t0\t1054\n23\t8\t44\n12\t9\t419\n22\t7\t322\n7\t8\t35\n23\t9\t238\n8\t4\t86\n18\t7\t278\n13\t2\t141\n10\t3\t826\n5\t0\t273\n15\t4\t134\n0\t8\t43\n3\t2\t16\n1\t5\t114\n5\t2\t100\n15\t3\t1212\n20\t9\t381\n8\t0\t742\n5\t1\t20\n14\t7\t248\n9\t0\t772\n5\t3\t329\n19\t9\t422\n20\t4\t189\n23\t4\t81\n19\t3\t1273\n0\t6\t228\n18\t3\t1303\n12\t6\t236\n9\t9\t357\n0\t2\t68\n7\t7\t171\n3\t8\t19\n23\t1\t19\n4\t2\t54\n3\t4\t15\n19\t5\t116\n14\t1\t27\n22\t5\t134\n4\t4\t27\n11\t2\t72\n17\t5\t96\n21\t9\t382\n8\t6\t155\n6\t6\t123\n2\t8\t25\n0\t3\t1472\n10\t7\t186\n3\t0\t352\n20\t6\t270\n10\t0\t876\n9\t6\t202\n1\t6\t114\n4\t1\t11\n14\t5\t138\n13\t1\t42\n3\t7\t113\n6\t9\t275\n19\t0\t1193\n0\t4\t50\n16\t5\t90\n5\t9\t185\n19\t8\t62\n12\t3\t920\n2\t7\t162\n4\t8\t22\n22\t2\t102\n17\t0\t1306\n14\t8\t78\n4\t5\t62\n22\t4\t123\n15\t0\t1366\n5\t5\t84\n7\t0\t622\n7\t6\t151\n22\t1\t19\n22\t3\t1678\n6\t4\t43\n10\t8\t51\n2\t6\t75\n"}]},"apps":[],"jobName":"paragraph_1531437768287_-252361031","id":"20180710-155035_1313556073","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30655"},{"title":"Which hours have the highest number of pickups?","text":"z.show(sqlContext.sql(\"SELECT hour(uber.dt) as hr,count(cid) as ct FROM uber group By hour(uber.dt)\"))","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tct\n12\t2090\n22\t2191\n1\t1295\n13\t2454\n16\t3765\n6\t1375\n3\t788\n20\t2768\n5\t901\n19\t3892\n15\t3451\n17\t3917\n9\t1917\n4\t739\n8\t2017\n23\t1766\n7\t1836\n10\t1931\n21\t1979\n11\t1988\n14\t2893\n2\t858\n0\t1766\n18\t4063\n"}]},"apps":[],"jobName":"paragraph_1531437768287_-252361031","id":"20180703-140559_1343329739","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30656"},{"title":"Which clusters have the highest number of pickups?","text":"%sql\nSELECT COUNT(cid), cid\nFROM uber\nGROUP BY cid\nORDER BY COUNT(cid) DESC","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"cid","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"count(cid)","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(cid)\tcid\n17494\t3\n16005\t0\n5984\t9\n3545\t7\n3459\t6\n1827\t4\n1785\t5\n1405\t2\n793\t8\n343\t1\n"}]},"apps":[],"jobName":"paragraph_1531437768287_-252361031","id":"20180703-140713_229458001","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30657"},{"title":"Calculate hourly window counts by cluster","text":"val countsDF = df.groupBy($\"cid\", window($\"dt\", \"1 hour\")).count()\ncountsDF.createOrReplaceTempView(\"uber_counts\")","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"countsDF: org.apache.spark.sql.DataFrame = [cid: int, window: struct<start: timestamp, end: timestamp> ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1531437768287_-252361031","id":"20180614-164843_864532661","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30658"},{"title":"Show the latest hourly counts by cluster","text":"%sql select * from uber_counts order by window desc limit 100 ","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"cid","index":0,"aggr":"sum"}],"groups":[{"name":"window","index":1,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cid\twindow\tcount\n6\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t73\n8\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t14\n4\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t35\n9\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t106\n1\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t10\n0\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t242\n3\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t258\n2\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t23\n5\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t41\n7\t[2014-08-02 20:00:00.0,2014-08-02 21:00:00.0]\t72\n8\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t36\n1\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t11\n2\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t53\n6\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t148\n4\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t35\n9\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t206\n7\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t158\n0\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t493\n5\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t72\n3\t[2014-08-02 19:00:00.0,2014-08-02 20:00:00.0]\t587\n6\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t157\n8\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t25\n2\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t31\n4\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t51\n7\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t166\n1\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t3\n3\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t576\n5\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t70\n0\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t556\n9\t[2014-08-02 18:00:00.0,2014-08-02 19:00:00.0]\t257\n5\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t54\n1\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t9\n0\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t457\n6\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t154\n7\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t138\n8\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t39\n4\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t58\n3\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t555\n9\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t215\n2\t[2014-08-02 17:00:00.0,2014-08-02 18:00:00.0]\t28\n4\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t74\n8\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t20\n0\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t484\n2\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t42\n7\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t147\n6\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t155\n5\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t54\n3\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t483\n9\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t202\n1\t[2014-08-02 16:00:00.0,2014-08-02 17:00:00.0]\t9\n3\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t499\n9\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t191\n0\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t451\n4\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t57\n2\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t47\n8\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t38\n7\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t118\n6\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t133\n1\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t9\n5\t[2014-08-02 15:00:00.0,2014-08-02 16:00:00.0]\t48\n6\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t116\n7\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t97\n3\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t392\n1\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t9\n5\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t66\n2\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t60\n8\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t37\n4\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t54\n0\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t351\n9\t[2014-08-02 14:00:00.0,2014-08-02 15:00:00.0]\t151\n2\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t40\n4\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t50\n3\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t333\n1\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t5\n6\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t84\n7\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t87\n8\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t25\n5\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t39\n9\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t142\n0\t[2014-08-02 13:00:00.0,2014-08-02 14:00:00.0]\t276\n3\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t302\n1\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t11\n0\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t295\n7\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t54\n9\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t143\n4\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t42\n6\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t89\n5\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t49\n8\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t28\n2\t[2014-08-02 12:00:00.0,2014-08-02 13:00:00.0]\t20\n5\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t50\n4\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t44\n9\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t129\n2\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t24\n8\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t15\n1\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t4\n3\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t285\n6\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t72\n0\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t251\n7\t[2014-08-02 11:00:00.0,2014-08-02 12:00:00.0]\t59\n"}]},"apps":[],"jobName":"paragraph_1531437768287_-252361031","id":"20170926-153747_2050113383","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30659"},{"title":"Display datetime and cluster counts for Uber trips","text":"%sql select cid, dt, count(cid) as count from uber group by dt, cid order by dt, cid limit 100 \n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"dt","index":1,"aggr":"sum"}],"groups":[{"name":"cid","index":0,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cid\tdt\tcount\n0\t2014-08-01 00:00:00.0\t3\n3\t2014-08-01 00:00:00.0\t2\n5\t2014-08-01 00:00:00.0\t1\n6\t2014-08-01 00:00:00.0\t2\n7\t2014-08-01 00:00:00.0\t1\n0\t2014-08-01 00:01:00.0\t3\n2\t2014-08-01 00:01:00.0\t1\n3\t2014-08-01 00:01:00.0\t2\n5\t2014-08-01 00:01:00.0\t1\n6\t2014-08-01 00:01:00.0\t1\n7\t2014-08-01 00:01:00.0\t1\n9\t2014-08-01 00:01:00.0\t1\n0\t2014-08-01 00:02:00.0\t1\n2\t2014-08-01 00:02:00.0\t1\n3\t2014-08-01 00:02:00.0\t2\n4\t2014-08-01 00:02:00.0\t1\n5\t2014-08-01 00:02:00.0\t1\n6\t2014-08-01 00:02:00.0\t1\n7\t2014-08-01 00:02:00.0\t1\n8\t2014-08-01 00:02:00.0\t1\n0\t2014-08-01 00:03:00.0\t3\n3\t2014-08-01 00:03:00.0\t4\n4\t2014-08-01 00:03:00.0\t1\n5\t2014-08-01 00:03:00.0\t1\n6\t2014-08-01 00:03:00.0\t2\n7\t2014-08-01 00:03:00.0\t1\n9\t2014-08-01 00:03:00.0\t2\n0\t2014-08-01 00:04:00.0\t2\n3\t2014-08-01 00:04:00.0\t4\n5\t2014-08-01 00:04:00.0\t1\n6\t2014-08-01 00:04:00.0\t1\n9\t2014-08-01 00:04:00.0\t1\n0\t2014-08-01 00:05:00.0\t1\n3\t2014-08-01 00:05:00.0\t2\n6\t2014-08-01 00:05:00.0\t1\n7\t2014-08-01 00:05:00.0\t1\n0\t2014-08-01 00:06:00.0\t3\n2\t2014-08-01 00:06:00.0\t1\n3\t2014-08-01 00:06:00.0\t3\n7\t2014-08-01 00:06:00.0\t2\n9\t2014-08-01 00:06:00.0\t2\n0\t2014-08-01 00:07:00.0\t1\n3\t2014-08-01 00:07:00.0\t3\n9\t2014-08-01 00:07:00.0\t2\n0\t2014-08-01 00:08:00.0\t3\n2\t2014-08-01 00:08:00.0\t1\n3\t2014-08-01 00:08:00.0\t3\n4\t2014-08-01 00:08:00.0\t1\n8\t2014-08-01 00:08:00.0\t1\n9\t2014-08-01 00:08:00.0\t1\n0\t2014-08-01 00:09:00.0\t1\n3\t2014-08-01 00:09:00.0\t3\n6\t2014-08-01 00:09:00.0\t1\n7\t2014-08-01 00:09:00.0\t2\n9\t2014-08-01 00:09:00.0\t1\n0\t2014-08-01 00:10:00.0\t2\n3\t2014-08-01 00:10:00.0\t3\n7\t2014-08-01 00:10:00.0\t3\n9\t2014-08-01 00:10:00.0\t2\n0\t2014-08-01 00:11:00.0\t3\n3\t2014-08-01 00:11:00.0\t3\n5\t2014-08-01 00:11:00.0\t1\n6\t2014-08-01 00:11:00.0\t1\n7\t2014-08-01 00:11:00.0\t2\n0\t2014-08-01 00:12:00.0\t2\n3\t2014-08-01 00:12:00.0\t3\n6\t2014-08-01 00:12:00.0\t1\n7\t2014-08-01 00:12:00.0\t1\n9\t2014-08-01 00:12:00.0\t1\n0\t2014-08-01 00:13:00.0\t2\n2\t2014-08-01 00:13:00.0\t1\n3\t2014-08-01 00:13:00.0\t4\n6\t2014-08-01 00:13:00.0\t1\n7\t2014-08-01 00:13:00.0\t1\n9\t2014-08-01 00:13:00.0\t1\n0\t2014-08-01 00:14:00.0\t2\n3\t2014-08-01 00:14:00.0\t3\n7\t2014-08-01 00:14:00.0\t2\n9\t2014-08-01 00:14:00.0\t3\n0\t2014-08-01 00:15:00.0\t2\n3\t2014-08-01 00:15:00.0\t2\n5\t2014-08-01 00:15:00.0\t1\n6\t2014-08-01 00:15:00.0\t1\n7\t2014-08-01 00:15:00.0\t2\n0\t2014-08-01 00:16:00.0\t3\n3\t2014-08-01 00:16:00.0\t2\n5\t2014-08-01 00:16:00.0\t2\n6\t2014-08-01 00:16:00.0\t2\n7\t2014-08-01 00:16:00.0\t1\n9\t2014-08-01 00:16:00.0\t2\n0\t2014-08-01 00:17:00.0\t3\n2\t2014-08-01 00:17:00.0\t1\n3\t2014-08-01 00:17:00.0\t4\n6\t2014-08-01 00:17:00.0\t1\n7\t2014-08-01 00:17:00.0\t1\n9\t2014-08-01 00:17:00.0\t1\n0\t2014-08-01 00:18:00.0\t3\n3\t2014-08-01 00:18:00.0\t2\n5\t2014-08-01 00:18:00.0\t1\n6\t2014-08-01 00:18:00.0\t1\n"}]},"apps":[],"jobName":"paragraph_1531437768288_-266596740","id":"20180710-134950_1592290482","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30660"},{"title":"What is the  count by cluster id","text":"%sql select cid, count(*) as cnt from uber group by cid \n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"cid","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"cnt","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cid\tcnt\n1\t453\n6\t4874\n3\t24222\n5\t2639\n9\t7961\n4\t2497\n8\t1113\n7\t5178\n2\t1932\n0\t20836\n"}]},"apps":[],"jobName":"paragraph_1531437768288_-266596740","id":"20180627-103141_2046860459","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30661"},{"title":"Examine Query Plan","text":"df.groupBy(\"cid\").count().orderBy(desc(\"count\")).explain()","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\n*Sort [count#180441L DESC NULLS LAST], true, 0\n+- Exchange rangepartitioning(count#180441L DESC NULLS LAST, 200)\n   +- *HashAggregate(keys=[cid#131743], functions=[count(1)])\n      +- Exchange hashpartitioning(cid#131743, 200)\n         +- *HashAggregate(keys=[cid#131743], functions=[partial_count(1)])\n            +- InMemoryTableScan [cid#131743]\n                  +- InMemoryRelation [_id#131738, dt#131739, lat#131740, lon#131741, base#131742, cid#131743, clat#131744, clon#131745], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n                        +- *Scan MapRDBRelation(/apps/ubertable,StructType(StructField(_id,StringType,true), StructField(dt,TimestampType,true), StructField(lat,DoubleType,true), StructField(lon,DoubleType,true), StructField(base,StringType,true), StructField(cid,IntegerType,true), StructField(clat,DoubleType,true), StructField(clon,DoubleType,true)),MapRDBTableScanRDD[46820] at RDD at MapRDBBaseRDD.scala:21,InsertOrReplace) [_id#131738,dt#131739,lat#131740,lon#131741,base#131742,cid#131743,clat#131744,clon#131745] ReadSchema: struct<_id:string,dt:timestamp,lat:double,lon:double,base:string,cid:int,clat:double,clon:double>\n"}]},"apps":[],"jobName":"paragraph_1531437768288_-266596740","id":"20170926-154028_1750564760","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30662"},{"title":"Top count of uber trip by day, hour, cluster","text":"    df.select( dayofmonth($\"dt\").alias(\"day\"), hour($\"dt\").alias(\"hour\"), $\"cid\").groupBy(\"day\", \"hour\", \"cid\").agg(count(\"cid\").alias(\"count\")).orderBy(desc(\"count\")).show","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+---+-----+\n|day|hour|cid|count|\n+---+----+---+-----+\n|  1|  16|  0|  948|\n|  1|  17|  0|  849|\n|  2|  22|  3|  840|\n|  1|  22|  3|  838|\n|  1|  17|  3|  788|\n|  1|  18|  0|  788|\n|  1|  15|  0|  784|\n|  1|  23|  3|  759|\n|  1|  18|  3|  727|\n|  1|  19|  0|  700|\n|  3|   0|  3|  693|\n|  1|  19|  3|  686|\n|  2|  23|  3|  685|\n|  1|  22|  0|  661|\n|  2|  21|  3|  656|\n|  1|  21|  0|  642|\n|  1|  16|  3|  639|\n|  1|  21|  3|  635|\n|  1|  20|  3|  635|\n|  2|   0|  3|  626|\n+---+----+---+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1531437768288_-266596740","id":"20170926-154123_820143714","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30663"},{"title":"Load the Cluster Centers for plotting on a Map","text":"import org.apache.spark.ml.clustering.KMeansModel\nval model = KMeansModel.load(\"/apps/ubermodel\")\nmodel.clusterCenters.foreach(println)\nval clusters = model.clusterCenters","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.clustering.KMeansModel\nmodel: org.apache.spark.ml.clustering.KMeansModel = kmeans_cdc4b2fd956a\n[40.7564201526695,-73.98253669425347]\n[40.69774864372469,-74.1746190485833]\n[40.65913663371848,-73.77616609142027]\n[40.727167721391965,-73.99996932251409]\n[40.76353997924329,-73.86457868292527]\n[40.687090541492736,-73.93082539975063]\n[40.68442577627514,-73.98240710059163]\n[40.722999595221516,-73.95202518341551]\n[40.63872788232504,-73.98280701524538]\n[40.78630539643714,-73.95464630711642]\nclusters: Array[org.apache.spark.ml.linalg.Vector] = Array([40.7564201526695,-73.98253669425347], [40.69774864372469,-74.1746190485833], [40.65913663371848,-73.77616609142027], [40.727167721391965,-73.99996932251409], [40.76353997924329,-73.86457868292527], [40.687090541492736,-73.93082539975063], [40.68442577627514,-73.98240710059163], [40.722999595221516,-73.95202518341551], [40.63872788232504,-73.98280701524538], [40.78630539643714,-73.95464630711642])\n"}]},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20180703-145309_2060363365","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30664"},{"text":"\nval points = df.select(\"lat\",\"lon\", \"cid\")\n .orderBy(desc(\"dt\")).limit(5000)\n\nval parray = points.collect() ","dateUpdated":"2018-07-12T16:22:48-0700","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"points: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [lat: double, lon: double ... 1 more field]\nparray: Array[org.apache.spark.sql.Row] = Array([40.7486,-73.8956,4], [40.7332,-74.0096,3], [40.6967,-73.9255,5], [40.6685,-73.9761,6], [40.7228,-73.7792,2], [40.7304,-73.982,3], [40.703,-73.9836,6], [40.7198,-73.9557,7], [40.7154,-74.0071,3], [40.8496,-73.9387,9], [40.8106,-73.926,9], [40.7663,-73.9915,0], [40.7413,-73.9978,3], [40.7853,-73.9711,9], [40.7257,-73.9999,3], [40.7408,-73.7585,2], [40.6448,-73.7819,2], [40.7234,-74.0017,3], [40.7434,-73.9961,3], [40.7424,-73.9067,4], [40.6956,-73.9684,6], [40.7113,-73.9469,7], [40.7826,-73.9588,9], [40.764,-73.9194,9], [40.7674,-73.9848,0], [40.7564,-73.9975,0], [40.7656,-73.9636,0], [40.7439,-74.0063,3], [40.7052,-74.0097,3], [40.7341,-74.0041,3], [40.7218,-73.958,7], [40.7872,-73.9753,9], [40.7213,-73.9874,3], [40.768,-73.9833,0], [40.723..."}]},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20180709-093604_1493917163","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30665"},{"title":"Bind Spark variables to Angular Javascript variables","text":"z.angularBind(\"centroid\", clusters)\nz.angularBind(\"locs\", parray)\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20180703-145026_789566308","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30666"},{"text":"%angular\n<!-- Avoid constantly editing JS and list the Angular vars you want exposed in an HTML attribute: -->\n<div id=\"dummy\" vars=\"centroid,locs\"></div>\n<script type=\"text/javascript\">\n  //Given an element in the note & list of values to fetch from Spark\n  //window.angularVars.myVal will be current value of backend Spark val of same name\n  function hoist(element){\n    var varNames = element.attr('vars').split(',');\n    window.angularVars = {};\n    var scope = angular.element(element.parent('.ng-scope')).scope().compiledScope;\n    $.each(varNames, function(i, v){\n      window[v+'-watcher'] = scope.$watch(v, function(newVal, oldVal){\n        window.angularVars[v] = newVal;\n      });\n    });\n  }\n  hoist($('#dummy'));\n</script>","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<!-- Avoid constantly editing JS and list the Angular vars you want exposed in an HTML attribute: -->\n<div id=\"dummy\" vars=\"centroid,locs\"></div>\n<script type=\"text/javascript\">\n  //Given an element in the note & list of values to fetch from Spark\n  //window.angularVars.myVal will be current value of backend Spark val of same name\n  function hoist(element){\n    var varNames = element.attr('vars').split(',');\n    window.angularVars = {};\n    var scope = angular.element(element.parent('.ng-scope')).scope().compiledScope;\n    $.each(varNames, function(i, v){\n      window[v+'-watcher'] = scope.$watch(v, function(newVal, oldVal){\n        window.angularVars[v] = newVal;\n      });\n    });\n  }\n  hoist($('#dummy'));\n</script>"}]},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20171003-225856_937234821","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30667"},{"title":"Display Cluster center Markers and Last 5000 trip locations on Map","text":"%angular\n<div id=\"map\" style=\"height:500px;width:100%;\"></div>\n<script type=\"text/javascript\">\nfunction circle(pos, color, map){\n    var circle = new google.maps.Circle({\n        strokeColor: color,\n        strokeOpacity: 0.8,\n        strokeWeight: 1,\n        fillColor: color,\n        fillOpacity: 0.3,\n        map: map,\n        center: pos,\n        radius: 100   //default: 6.5\n    });\n}\n\nfunction initMap() {\n    var centroid = window.angularVars.centroid;\n    var colors = [\"blue\", \"red\",\"green\",\"OrangeRed\",\"purple\", \"orange\",\"BlueViolet\",\"Maroon\", \"HotPink\", \"LightCoral\"]\n    var locs = window.angularVars.locs;\n    var NYC = {lat: 40.76664545866995, lng: -73.971943532955};\n    var map = new google.maps.Map(document.getElementById('map'), {zoom: 11, center: NYC });\n    //  Draw circles for each Centroid\n    $.each(centroid, function(i, v){\n         var pos = {lat: parseFloat(v.values[0]), lng: parseFloat(v.values[1]) };\n          marker = new google.maps.Marker({\n                            position: pos,\n                            label: String(i),\n                            map: map\n                        });\n    });\n    $.each(locs, function(i, v){\n         var pos = {lat: parseFloat(v.values[0]), lng: parseFloat(v.values[1]) };\n         var color =colors[ v.values[2]] ;\n         circle(pos, color, map);\n    });\n    \n}\n\n//Only load GMaps once\nif (typeof google === 'object' && typeof google.maps === 'object') initMap();\nelse {\n    var script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    //Replace with your API key\n    var apiKey = 'AIzaSyBbKXTPdUuKimkq5ONrChpNuxnI5SMhMUI';\n    script.src = \"https://maps.googleapis.com/maps/api/js?key=\"+apiKey+\"&libraries=visualization&callback=initMap\";\n    document.body.appendChild(script);\n}\n</script>","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<div id=\"map\" style=\"height:500px;width:100%;\"></div>\n<script type=\"text/javascript\">\nfunction circle(pos, color, map){\n    var circle = new google.maps.Circle({\n        strokeColor: color,\n        strokeOpacity: 0.8,\n        strokeWeight: 1,\n        fillColor: color,\n        fillOpacity: 0.3,\n        map: map,\n        center: pos,\n        radius: 100   //default: 6.5\n    });\n}\n\nfunction initMap() {\n    var centroid = window.angularVars.centroid;\n    var colors = [\"blue\", \"red\",\"green\",\"OrangeRed\",\"purple\", \"orange\",\"BlueViolet\",\"Maroon\", \"HotPink\", \"LightCoral\"]\n    var locs = window.angularVars.locs;\n    var NYC = {lat: 40.76664545866995, lng: -73.971943532955};\n    var map = new google.maps.Map(document.getElementById('map'), {zoom: 11, center: NYC });\n    //  Draw circles for each Centroid\n    $.each(centroid, function(i, v){\n         var pos = {lat: parseFloat(v.values[0]), lng: parseFloat(v.values[1]) };\n          marker = new google.maps.Marker({\n                            position: pos,\n                            label: String(i),\n                            map: map\n                        });\n    });\n    $.each(locs, function(i, v){\n         var pos = {lat: parseFloat(v.values[0]), lng: parseFloat(v.values[1]) };\n         var color =colors[ v.values[2]] ;\n         circle(pos, color, map);\n    });\n    \n}\n\n//Only load GMaps once\nif (typeof google === 'object' && typeof google.maps === 'object') initMap();\nelse {\n    var script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    //Replace with your API key\n    var apiKey = 'AIzaSyBbKXTPdUuKimkq5ONrChpNuxnI5SMhMUI';\n    script.src = \"https://maps.googleapis.com/maps/api/js?key=\"+apiKey+\"&libraries=visualization&callback=initMap\";\n    document.body.appendChild(script);\n}\n</script>"}]},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20180703-144133_2026277884","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30668"},{"text":"\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1531437768289_-266981489","id":"20180709-145440_342470051","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30669"},{"text":"\n","dateUpdated":"2018-07-12T16:22:48-0700","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1531437768290_-265827242","id":"20180709-094358_2063595141","dateCreated":"2018-07-12T16:22:48-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30670"}],"name":"SparkUberSQLMapR-DB1","id":"2DHFXRCCX","angularObjects":{"2D1RDNPG7:shared_process":[],"2CZY6RGGW:shared_process":[],"2D1X9BGYQ:shared_process":[],"2D23NTXKZ:shared_process":[],"2D17U7MQZ:shared_process":[],"2D1G7DFJ3:shared_process":[],"2D1N6AW6W:shared_process":[],"2D2AEVMHC:shared_process":[],"2D11UYDEH:shared_process":[],"2D1AEZYWW:shared_process":[],"2D4B74HZR:shared_process":[],"2CZVDCKWE:shared_process":[],"2D2SQCKKS:shared_process":[],"2D11WSKEQ:shared_process":[],"2D2CKFTGH:shared_process":[],"2D3PPPREV:shared_process":[],"2D3TRC9QZ:shared_process":[],"2D1HQ6WB4:shared_process":[],"2D1NT65H6:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}