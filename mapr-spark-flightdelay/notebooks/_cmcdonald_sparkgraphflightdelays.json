{"paragraphs":[{"text":"%spark.dep\nz.load(\"graphframes:graphframes:0.6.0-spark2.3-s_2.11\")","user":"mapr","dateUpdated":"2018-11-01T16:13:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@3edb3a4f\n"}]},"apps":[],"jobName":"paragraph_1540936764870_1582818971","id":"20181030-215924_485209539","dateCreated":"2018-10-30T21:59:24+0000","dateStarted":"2018-11-01T16:13:22+0000","dateFinished":"2018-11-01T16:13:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:33882"},{"title":"Import needed packages","text":"\nimport org.apache.spark._\nimport org.apache.spark.graphx._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.types.StructType\nimport org.graphframes._\nimport org.graphframes.lib.AggregateMessages\n\n","user":"mapr","dateUpdated":"2018-11-01T16:13:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.graphx._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.types.StructType\nimport org.graphframes._\nimport org.graphframes.lib.AggregateMessages\n"}]},"apps":[],"jobName":"paragraph_1540934193097_1395947218","id":"20170508-144514_403247535","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-11-01T16:13:43+0000","dateFinished":"2018-11-01T16:14:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33883"},{"text":"%sh \nls /public_data/demos_flightdelay\nhadoop fs -ls /user/mapr/\n","user":"mapr","dateUpdated":"2018-10-30T21:18:03+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"airports.json\nflightdata.json\nflights20170102.json\nflights2018.json\nflightsapr2018.json\nflightsfeb2018.json\nflightsjan2018.json\nflightsmar2018.json\njuly.json\njune.json\nmay.json\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 6 items\n-rwxr-xr-x   3 mapr mapr         14 2018-10-29 15:19 /user/mapr/.recent_tables\ndrwxr-xr-x   - mapr mapr          1 2018-10-30 21:16 /user/mapr/.sparkStaging\ndrwxr-xr-x   - mapr mapr          1 2018-10-29 15:18 /user/mapr/drill\ntr--------   - mapr mapr          3 2018-10-29 15:19 /user/mapr/ps\ndrwxrwxrwx   - mapr mapr          1 2018-10-29 15:18 /user/mapr/tmp\ndrwxr-xr-x   - mapr mapr          1 2018-10-29 15:18 /user/mapr/zeppelin\n"}]},"apps":[],"jobName":"paragraph_1540934193100_-950656674","id":"20181003-212056_1014503768","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T21:17:22+0000","dateFinished":"2018-10-30T21:17:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33884"},{"text":"%sh\nhadoop fs -mkdir /user/mapr/data\nhadoop fs -put /public_data/demos_flightdelay/flights20170102.json /user/mapr/data/.\nhadoop fs -ls /user/mapr/data","user":"mapr","dateUpdated":"2018-10-30T21:18:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 1 items\n-rwxr-xr-x   3 mapr mapr    8827642 2018-10-30 21:18 /user/mapr/data/flights20170102.json\n"}]},"apps":[],"jobName":"paragraph_1540934226906_-1692031146","id":"20181030-211706_387483666","dateCreated":"2018-10-30T21:17:06+0000","dateStarted":"2018-10-30T21:18:56+0000","dateFinished":"2018-10-30T21:18:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33885"},{"text":"%sh\nhadoop fs -put /public_data/demos_flightdelay/airports.json /user/mapr/data/.\nhadoop fs -ls /user/mapr/data","user":"mapr","dateUpdated":"2018-10-30T21:19:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 2 items\n-rwxr-xr-x   3 mapr mapr        533 2018-10-30 21:19 /user/mapr/data/airports.json\n-rwxr-xr-x   3 mapr mapr    8827642 2018-10-30 21:18 /user/mapr/data/flights20170102.json\n"}]},"apps":[],"jobName":"paragraph_1540934237426_1875930058","id":"20181030-211717_1670211411","dateCreated":"2018-10-30T21:17:17+0000","dateStarted":"2018-10-30T21:19:48+0000","dateFinished":"2018-10-30T21:19:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33886"},{"text":"%md \nFor this tutorial, we'll be using data from http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time.\nThe CSV data has been cleaned and tranformed into 2 JSON files with the following format: \n{\"dofM\":1,\"dofW\":7,\"carrier\":\"AA\",\"fldate\":\"2017-01-01\",\"flnum\":\"1678\",\"origin\":\"ATL\",\"dest\":\"LGA\",\"crsdephour\":17,\"crsdeptime\":1700,\"depdelay\":0.0,\"crsarrtime\":1912,\"arrdelay\":0.0,\"crselapsedtime\":132.0,\"dist\":762.0}\n\nWe use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.","user":"mapr","dateUpdated":"2018-10-30T21:18:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>For this tutorial, we&rsquo;ll be using data from <a href=\"http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time\">http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time</a>.<br/>The CSV data has been cleaned and tranformed into 2 JSON files with the following format:<br/>{&ldquo;dofM&rdquo;:1,&ldquo;dofW&rdquo;:7,&ldquo;carrier&rdquo;:&ldquo;AA&rdquo;,&ldquo;fldate&rdquo;:&ldquo;2017-01-01&rdquo;,&ldquo;flnum&rdquo;:&ldquo;1678&rdquo;,&ldquo;origin&rdquo;:&ldquo;ATL&rdquo;,&ldquo;dest&rdquo;:&ldquo;LGA&rdquo;,&ldquo;crsdephour&rdquo;:17,&ldquo;crsdeptime&rdquo;:1700,&ldquo;depdelay&rdquo;:0.0,&ldquo;crsarrtime&rdquo;:1912,&ldquo;arrdelay&rdquo;:0.0,&ldquo;crselapsedtime&rdquo;:132.0,&ldquo;dist&rdquo;:762.0}</p>\n<p>We use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1540934193101_-856482128","id":"20170530-122945_1594214131","dateCreated":"2018-10-30T21:16:33+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33887"},{"title":"Define Schema for JSON file data","text":"\ncase class Flight(_id: String, dofW: Integer, carrier: String, origin: String,\n    dest: String, crsdephour: Integer, crsdeptime: Double, depdelay: Double,\n    crsarrtime: Double, arrdelay: Double, crselapsedtime: Double, dist: Double)\n\n\nval schema = StructType(Array(\n    StructField(\"_id\", StringType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"origin\", StringType, true),\n    StructField(\"dest\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", DoubleType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", DoubleType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))\n   ","user":"mapr","dateUpdated":"2018-10-30T22:03:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Flight\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(_id,StringType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(origin,StringType,true), StructField(dest,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,DoubleType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,DoubleType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1540934193103_617215375","id":"20170508-150032_326029627","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:03:45+0000","dateFinished":"2018-10-30T22:03:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33888"},{"title":"Read the data from JSON file into a Dataset of type Flight","text":"\nimport spark.implicits._\n\n var file =\"maprfs:///user/mapr/data/flights20170102.json\"\n\n val df: Dataset[Flight] = spark.read.format(\"json\").option(\"inferSchema\", \"false\").schema(schema).load(file).as[Flight]\n \n df.show\n","user":"mapr","dateUpdated":"2018-10-30T22:04:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nfile: String = maprfs:///user/mapr/data/flights20170102.json\ndf: org.apache.spark.sql.Dataset[Flight] = [_id: string, dofW: int ... 10 more fields]\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\n|                 _id|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1409.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        13|    1335.0|     0.0|    1600.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1644.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        16|    1616.0|    15.0|    1849.0|     0.0|         153.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        18|    1845.0|     0.0|    2110.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        19|    1905.0|    15.0|    2133.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        22|    2205.0|     0.0|      29.0|     0.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|         9|     859.0|    30.0|    1127.0|    11.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        10|    1004.0|    10.0|    1236.0|     3.0|         152.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1410.0|    19.0|         149.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        13|    1305.0|    16.0|    1529.0|     5.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1646.0|     0.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        14|    1350.0|    25.0|    1615.0|    16.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        15|    1510.0|    12.0|    1745.0|     4.0|         155.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        16|    1616.0|    68.0|    1852.0|    49.0|         156.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        18|    1750.0|    61.0|    2027.0|    64.0|         157.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        19|    1905.0|    36.0|    2135.0|    23.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        21|    2055.0|    74.0|    2325.0|    63.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        22|    2205.0|    29.0|      32.0|    21.0|         147.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|         7|     725.0|     2.0|     954.0|     0.0|         149.0|946.0|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193104_-1893399673","id":"20170508-150131_378637203","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:04:01+0000","dateFinished":"2018-10-30T22:04:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33889"},{"title":"Print DataFrame Schema","text":"df.cache\ndf.count()\ndf.createOrReplaceTempView(\"flights\")\ndf.printSchema","user":"mapr","dateUpdated":"2018-10-30T22:07:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res12: df.type = [_id: string, dofW: int ... 10 more fields]\nres13: Long = 41348\nroot\n |-- _id: string (nullable = true)\n |-- dofW: integer (nullable = true)\n |-- carrier: string (nullable = true)\n |-- origin: string (nullable = true)\n |-- dest: string (nullable = true)\n |-- crsdephour: integer (nullable = true)\n |-- crsdeptime: double (nullable = true)\n |-- depdelay: double (nullable = true)\n |-- crsarrtime: double (nullable = true)\n |-- arrdelay: double (nullable = true)\n |-- crselapsedtime: double (nullable = true)\n |-- dist: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1540934193106_762887002","id":"20171129-223643_463511351","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:07:12+0000","dateFinished":"2018-10-30T22:07:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33890"},{"text":"%md\nThe describe() function performs summary statistics calculations on  numeric columns ","user":"mapr","dateUpdated":"2018-10-30T21:18:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The describe() function performs summary statistics calculations on numeric columns</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1540934193109_-520018305","id":"20170524-214640_973339640","dateCreated":"2018-10-30T21:16:33+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33891"},{"title":"Perform summary statistics  on selected columns","text":"\ndf.describe(\"dist\", \"crselapsedtime\",\"depdelay\", \"arrdelay\").show","user":"mapr","dateUpdated":"2018-10-30T22:05:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+------------------+------------------+------------------+\n|summary|              dist|    crselapsedtime|          depdelay|          arrdelay|\n+-------+------------------+------------------+------------------+------------------+\n|  count|             41348|             41348|             41348|             41348|\n|   mean|1111.0529167069749|186.26264873754474|15.018719164167553|14.806907226468027|\n| stddev| 568.7941212507534| 68.38149648990007|44.529632044361364| 44.22370513266619|\n|    min|             184.0|              64.0|               0.0|               0.0|\n|    max|            2704.0|             423.0|            1440.0|            1442.0|\n+-------+------------------+------------------+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193110_1142283848","id":"20170524-083228_1459810795","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:05:48+0000","dateFinished":"2018-10-30T22:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33892"},{"text":"%md \nUse Spark SQL to explore the dataset","user":"mapr","dateUpdated":"2018-10-30T21:18:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Use Spark SQL to explore the dataset</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1540934193113_-1108073129","id":"20170603-182655_1680505289","dateCreated":"2018-10-30T21:16:33+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33893"},{"title":"Top 5 Longest departure delays","text":"%sql \nselect carrier,origin, dest, depdelay,crsdephour, dist, dofW\nfrom flights \norder by depdelay desc limit 5 \n","user":"mapr","dateUpdated":"2018-10-30T22:07:49+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","origin":"string","dest":"string","depdelay":"string","crsdephour":"string","dist":"string","dofW":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\torigin\tdest\tdepdelay\tcrsdephour\tdist\tdofW\nAA\tSFO\tORD\t1440.0\t8\t1846.0\t3\nDL\tBOS\tATL\t1185.0\t17\t946.0\t6\nUA\tDEN\tEWR\t1138.0\t12\t1605.0\t4\nDL\tORD\tATL\t1087.0\t19\t606.0\t7\nUA\tMIA\tEWR\t1072.0\t20\t1085.0\t1\n"}]},"apps":[],"jobName":"paragraph_1540934193116_462232316","id":"20171110-195321_1924356975","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:07:49+0000","dateFinished":"2018-10-30T22:07:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33894"},{"title":"Average Departure Delay by Carrier","text":"%sql select carrier, avg(depdelay)\nfrom flights\ngroup by carrier","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tavg(depdelay)\nUA\t17.477878450696764\nAA\t10.45768118831622\nDL\t15.316061660865241\nWN\t13.491000418585182\n"}]},"apps":[],"jobName":"paragraph_1540934193117_-1967776802","id":"20171110-195759_439800395","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:07:57+0000","dateFinished":"2018-10-30T22:07:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33895"},{"title":"Maximum Departure Delay by Carrier","text":"%sql\nselect carrier, max(depdelay)\nfrom flights\ngroup by carrier","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"max(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tmax(depdelay)\nUA\t1138.0\nAA\t1440.0\nDL\t1185.0\nWN\t375.0\n"}]},"apps":[],"jobName":"paragraph_1540934193118_166421737","id":"20171129-194230_774307118","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:08:03+0000","dateFinished":"2018-10-30T22:08:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33896"},{"title":"Average Departure Delay by Destination","text":"%sql\nSELECT dest, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY dest\nORDER BY avgdelay desc","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dest","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dest\tavgdelay\nSFO\t25.12807752750131\nEWR\t20.27488714659064\nLGA\t14.455166867712103\nATL\t13.588656021290753\nORD\t13.525756600128783\nDEN\t12.728005691249704\nIAH\t12.658908507223114\nBOS\t12.395548404397962\nMIA\t12.364271232259519\n"}]},"apps":[],"jobName":"paragraph_1540934193120_1885842788","id":"20171122-204956_303346727","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:08:12+0000","dateFinished":"2018-10-30T22:08:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33897"},{"title":"Average Departure Delay by Origin","text":"%sql\nSELECT origin, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY origin\nORDER BY avgdelay desc","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tavgdelay\nSFO\t20.306176084099867\nEWR\t16.31737378525717\nDEN\t16.167720777699696\nIAH\t15.925946093111898\nORD\t14.880476190476191\nATL\t14.699547814436443\nMIA\t14.068474576271186\nBOS\t12.440173253925284\nLGA\t11.547475961538462\n"}]},"apps":[],"jobName":"paragraph_1540934193121_-921522161","id":"20171122-204822_1853914961","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:08:20+0000","dateFinished":"2018-10-30T22:08:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33898"},{"title":"Average Departure Delay by Day of the Week","text":"%sql\nSELECT dofW, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY dofW\nORDER BY avgdelay desc","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tavgdelay\n7\t18.75420240137221\n1\t17.404697121580984\n6\t16.829883897021706\n4\t14.609846568875401\n2\t13.50552611657835\n5\t13.10193236714976\n3\t11.3646816543676\n"}]},"apps":[],"jobName":"paragraph_1540934193122_-933062343","id":"20171122-205057_803943925","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:08:27+0000","dateFinished":"2018-10-30T22:08:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33899"},{"title":"Count of Departure Delays by Day of the Week (1=Monday, 7=Sunday)","text":"%sql\nselect dofW, count(depdelay)\nfrom flights where depdelay > 40\ngroup by dofW\n","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tcount(depdelay)\n1\t940\n6\t424\n3\t482\n5\t579\n4\t626\n7\t701\n2\t712\n"}]},"apps":[],"jobName":"paragraph_1540934193123_-1966973275","id":"20171123-101016_2040441762","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:08:36+0000","dateFinished":"2018-10-30T22:08:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33900"},{"title":"Count of Departure Delays by Hour of Day","text":"%sql\nselect crsdephour, count(depdelay)\nfrom flights where depdelay > 40\ngroup by crsdephour\n","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crsdephour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"crsdephour\tcount(depdelay)\n12\t227\n22\t65\n1\t1\n13\t336\n16\t351\n6\t68\n20\t230\n5\t15\n19\t371\n15\t331\n17\t474\n9\t175\n8\t190\n23\t27\n7\t112\n10\t284\n24\t9\n21\t160\n11\t280\n14\t353\n0\t9\n18\t396\n"}]},"apps":[],"jobName":"paragraph_1540934193126_-340071417","id":"20171129-200107_756396508","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:09:15+0000","dateFinished":"2018-10-30T22:09:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33901"},{"title":"Count of Departure Delays by Origin","text":"%sql\nselect origin, count(depdelay)\nfrom flights where depdelay > 40\ngroup by origin\nORDER BY origin","user":"mapr","dateUpdated":"2018-11-01T16:13:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tcount(depdelay)\nATL\t637\nBOS\t296\nDEN\t484\nEWR\t518\nIAH\t447\nLGA\t432\nMIA\t429\nORD\t679\nSFO\t542\n"}]},"apps":[],"jobName":"paragraph_1540934193128_967428883","id":"20171123-101839_1671246939","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:09:32+0000","dateFinished":"2018-10-30T22:09:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33902"},{"text":"%md\nRename required columns\n","user":"mapr","dateUpdated":"2018-11-01T16:15:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Rename required columns</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1540934193135_1793256319","id":"20170603-184811_78732818","dateCreated":"2018-10-30T21:16:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33903","dateFinished":"2018-11-01T16:15:12+0000","dateStarted":"2018-11-01T16:15:09+0000"},{"title":"Rename required columns for Edges DataFrame to id, src, dst","text":"val flights = df.withColumnRenamed(\"_id\", \"id\").withColumnRenamed(\"origin\", \"src\").withColumnRenamed(\"dest\", \"dst\").withColumnRenamed(\"depdelay\", \"delay\")\nflights.show   \nflights.createOrReplaceTempView(\"flights\")\n\n\n","user":"mapr","dateUpdated":"2018-11-01T16:17:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flights: org.apache.spark.sql.DataFrame = [id: string, dofW: int ... 10 more fields]\n+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\n|                  id|dofW|carrier|src|dst|crsdephour|crsdeptime|delay|crsarrtime|arrdelay|crselapsedtime| dist|\n+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        11|    1141.0|  0.0|    1409.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|ATL|BOS|        13|    1335.0|  0.0|    1600.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        14|    1416.0|  0.0|    1644.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        16|    1616.0| 15.0|    1849.0|     0.0|         153.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|ATL|BOS|        18|    1845.0|  0.0|    2110.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        19|    1905.0| 15.0|    2133.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        22|    2205.0|  0.0|      29.0|     0.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|         9|     859.0| 30.0|    1127.0|    11.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        10|    1004.0| 10.0|    1236.0|     3.0|         152.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        11|    1141.0|  0.0|    1410.0|    19.0|         149.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        13|    1305.0| 16.0|    1529.0|     5.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        14|    1416.0|  0.0|    1646.0|     0.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|ATL|BOS|        14|    1350.0| 25.0|    1615.0|    16.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        15|    1510.0| 12.0|    1745.0|     4.0|         155.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        16|    1616.0| 68.0|    1852.0|    49.0|         156.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        18|    1750.0| 61.0|    2027.0|    64.0|         157.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        19|    1905.0| 36.0|    2135.0|    23.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|ATL|BOS|        21|    2055.0| 74.0|    2325.0|    63.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        22|    2205.0| 29.0|      32.0|    21.0|         147.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|         7|     725.0|  2.0|     954.0|     0.0|         149.0|946.0|\n+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193136_2062361260","id":"20170508-150543_958647761","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:13:46+0000","dateFinished":"2018-10-30T22:13:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33904"},{"title":"Read airports file for Vertexes","text":"var file2: String = \"/user/mapr/data/airports.json\"\nval airports = spark.read.json(file2)\nairports.createOrReplaceTempView(\"airports\")\nairports.show\n","user":"mapr","dateUpdated":"2018-11-01T16:16:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"file2: String = /user/mapr/data/airports.json\nairports: org.apache.spark.sql.DataFrame = [City: string, Country: string ... 2 more fields]\n+-------------+-------+-----+---+\n|         City|Country|State| id|\n+-------------+-------+-----+---+\n|      Houston|    USA|   TX|IAH|\n|     New York|    USA|   NY|LGA|\n|       Boston|    USA|   MA|BOS|\n|       Newark|    USA|   NJ|EWR|\n|       Denver|    USA|   CO|DEN|\n|        Miami|    USA|   FL|MIA|\n|San Francisco|    USA|   CA|SFO|\n|      Atlanta|    USA|   GA|ATL|\n|      Chicago|    USA|   IL|ORD|\n+-------------+-------+-----+---+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193137_280067954","id":"20170524-223310_2121058884","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:13:10+0000","dateFinished":"2018-10-30T22:13:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33905"},{"title":"Create GraphFrame from Vertexes and Edges","text":"    val graph = GraphFrame(airports, flights)\n\n    graph.vertices.show    ","user":"mapr","dateUpdated":"2018-11-01T16:17:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"graph: org.graphframes.GraphFrame = GraphFrame(v:[id: string, City: string ... 2 more fields], e:[src: string, dst: string ... 10 more fields])\n+-------------+-------+-----+---+\n|         City|Country|State| id|\n+-------------+-------+-----+---+\n|      Houston|    USA|   TX|IAH|\n|     New York|    USA|   NY|LGA|\n|       Boston|    USA|   MA|BOS|\n|       Newark|    USA|   NJ|EWR|\n|       Denver|    USA|   CO|DEN|\n|        Miami|    USA|   FL|MIA|\n|San Francisco|    USA|   CA|SFO|\n|      Atlanta|    USA|   GA|ATL|\n|      Chicago|    USA|   IL|ORD|\n+-------------+-------+-----+---+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193138_-1394438785","id":"20170603-185445_276463997","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:14:25+0000","dateFinished":"2018-10-30T22:14:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33906"},{"text":"  graph.edges.show","user":"mapr","dateUpdated":"2018-11-01T16:18:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\n|                  id|dofW|carrier|src|dst|crsdephour|crsdeptime|delay|crsarrtime|arrdelay|crselapsedtime| dist|\n+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        11|    1141.0|  0.0|    1409.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|ATL|BOS|        13|    1335.0|  0.0|    1600.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        14|    1416.0|  0.0|    1644.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        16|    1616.0| 15.0|    1849.0|     0.0|         153.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|ATL|BOS|        18|    1845.0|  0.0|    2110.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        19|    1905.0| 15.0|    2133.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|        22|    2205.0|  0.0|      29.0|     0.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|ATL|BOS|         9|     859.0| 30.0|    1127.0|    11.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        10|    1004.0| 10.0|    1236.0|     3.0|         152.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        11|    1141.0|  0.0|    1410.0|    19.0|         149.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        13|    1305.0| 16.0|    1529.0|     5.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        14|    1416.0|  0.0|    1646.0|     0.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|ATL|BOS|        14|    1350.0| 25.0|    1615.0|    16.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        15|    1510.0| 12.0|    1745.0|     4.0|         155.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        16|    1616.0| 68.0|    1852.0|    49.0|         156.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        18|    1750.0| 61.0|    2027.0|    64.0|         157.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        19|    1905.0| 36.0|    2135.0|    23.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|ATL|BOS|        21|    2055.0| 74.0|    2325.0|    63.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|        22|    2205.0| 29.0|      32.0|    21.0|         147.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|ATL|BOS|         7|     725.0|  2.0|     954.0|     0.0|         149.0|946.0|\n+--------------------+----+-------+---+---+----------+----------+-----+----------+--------+--------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540937684348_-387458988","id":"20181030-221444_1694311441","dateCreated":"2018-10-30T22:14:44+0000","dateStarted":"2018-10-30T22:14:47+0000","dateFinished":"2018-10-30T22:14:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33907","title":"Show rows for GraphFrame edges"},{"text":"%md\nNow we can query the GraphFrame\n\n","user":"mapr","dateUpdated":"2018-11-01T16:19:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now we can query the GraphFrame</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1540934193139_2102274791","id":"20170601-154525_1033166149","dateCreated":"2018-10-30T21:16:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33908","dateFinished":"2018-11-01T16:19:02+0000","dateStarted":"2018-11-01T16:19:02+0000"},{"title":"What are the longest delays for  flights  that are greater than  1500 miles in  distance?","text":"graph.edges.filter(\"dist > 1500\").orderBy(desc(\"delay\")).show(5)\n","user":"mapr","dateUpdated":"2018-10-30T22:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\n|                  id|dofW|carrier|src|dst|crsdephour|crsdeptime| delay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\n|SFO_ORD_2017-02-2...|   3|     AA|SFO|ORD|         8|     800.0|1440.0|    1411.0|  1442.0|         251.0|1846.0|\n|DEN_EWR_2017-02-2...|   4|     UA|DEN|EWR|        12|    1244.0|1138.0|    1824.0|  1139.0|         220.0|1605.0|\n|DEN_LGA_2017-02-2...|   2|     DL|DEN|LGA|        16|    1605.0|1004.0|    2159.0|  1000.0|         234.0|1620.0|\n|MIA_SFO_2017-02-2...|   4|     UA|MIA|SFO|        18|    1755.0| 964.0|    2132.0|   977.0|         397.0|2585.0|\n|DEN_LGA_2017-01-2...|   7|     DL|DEN|LGA|        16|    1610.0| 952.0|    2159.0|   927.0|         229.0|1620.0|\n+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193140_-1456726938","id":"20170508-151557_1422077156","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:15:36+0000","dateFinished":"2018-10-30T22:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33909"},{"title":" Show the longest distance routes","text":"graph.edges.groupBy(\"src\", \"dst\").max(\"dist\").sort(desc(\"max(dist)\")).show(4)","user":"mapr","dateUpdated":"2018-11-01T16:19:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---------+\n|src|dst|max(dist)|\n+---+---+---------+\n|SFO|BOS|   2704.0|\n|BOS|SFO|   2704.0|\n|SFO|MIA|   2585.0|\n|MIA|SFO|   2585.0|\n+---+---+---------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193142_1401005596","id":"20170508-151903_1365343172","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:16:18+0000","dateFinished":"2018-10-30T22:16:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33911"},{"title":"Which flight routes have the highest average delay  ?","text":"graph.edges.groupBy(\"src\", \"dst\").avg(\"delay\").sort(desc(\"avg(delay)\")).show(5)","user":"mapr","dateUpdated":"2018-10-30T22:17:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+------------------+\n|src|dst|        avg(delay)|\n+---+---+------------------+\n|ATL|SFO|            33.505|\n|MIA|SFO| 32.30797101449275|\n|SFO|BOS| 26.77319587628866|\n|DEN|SFO|          26.45375|\n|IAH|SFO|26.002141327623125|\n+---+---+------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193143_105112103","id":"20171129-113112_994877662","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:17:18+0000","dateFinished":"2018-10-30T22:17:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33912"},{"title":"Count of departure delays by Origin and destination. ","text":"graph.edges.filter(\" delay > 40\").groupBy(\"src\", \"dst\").agg(count(\"delay\").as(\"flightcount\")).sort(desc(\"flightcount\")).show(5)\n","user":"mapr","dateUpdated":"2018-11-01T16:19:42+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-----------+\n|src|dst|flightcount|\n+---+---+-----------+\n|DEN|SFO|        172|\n|ORD|SFO|        168|\n|ATL|LGA|        155|\n|ATL|EWR|        141|\n|SFO|DEN|        134|\n+---+---+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193144_1144180000","id":"20171122-232203_359528816","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:17:47+0000","dateFinished":"2018-10-30T22:17:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33913"},{"title":"What are the longest delays for flights that are greater than 1500 miles in  distance?","text":"graph.edges.filter(\"dist > 1500\").orderBy(desc(\"delay\")).show(3)","user":"mapr","dateUpdated":"2018-10-30T22:19:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\n|                  id|dofW|carrier|src|dst|crsdephour|crsdeptime| delay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\n|SFO_ORD_2017-02-2...|   3|     AA|SFO|ORD|         8|     800.0|1440.0|    1411.0|  1442.0|         251.0|1846.0|\n|DEN_EWR_2017-02-2...|   4|     UA|DEN|EWR|        12|    1244.0|1138.0|    1824.0|  1139.0|         220.0|1605.0|\n|DEN_LGA_2017-02-2...|   2|     DL|DEN|LGA|        16|    1605.0|1004.0|    2159.0|  1000.0|         234.0|1620.0|\n+--------------------+----+-------+---+---+----------+----------+------+----------+--------+--------------+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193145_1990690883","id":"20171122-232845_814296940","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:19:00+0000","dateFinished":"2018-10-30T22:19:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33914"},{"title":"What is the average delay for delayed flights departing from Boston?","text":"graph.edges.filter(\"src = 'BOS' and delay > 1\").groupBy(\"src\", \"dst\").avg(\"delay\").sort(desc(\"avg(delay)\")).show\n","user":"mapr","dateUpdated":"2018-10-30T22:19:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+------------------+\n|src|dst|        avg(delay)|\n+---+---+------------------+\n|BOS|SFO| 50.44927536231884|\n|BOS|LGA| 49.19047619047619|\n|BOS|ATL| 39.67063492063492|\n|BOS|EWR| 38.65771812080537|\n|BOS|MIA| 35.88990825688074|\n|BOS|ORD| 34.74626865671642|\n|BOS|IAH|22.185567010309278|\n|BOS|DEN| 16.83177570093458|\n+---+---+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193147_-1788879839","id":"20170508-155848_1997894070","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:19:23+0000","dateFinished":"2018-10-30T22:19:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33916"},{"title":"Which airport has the most incoming flights? ","text":"graph.inDegrees.orderBy(desc(\"inDegree\")).show(3)\n","user":"mapr","dateUpdated":"2018-11-01T16:20:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+\n| id|inDegree|\n+---+--------+\n|ORD|    6212|\n|ATL|    6012|\n|LGA|    4974|\n+---+--------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193149_1639900487","id":"20170602-155622_1453197792","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:20:01+0000","dateFinished":"2018-10-30T22:20:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33918"},{"title":"Which airport has the most outgoing flights?","text":"graph.outDegrees.orderBy(desc(\"outDegree\")).show(3)","user":"mapr","dateUpdated":"2018-11-01T16:20:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---------+\n| id|outDegree|\n+---+---------+\n|ORD|     6300|\n|ATL|     5971|\n|LGA|     4992|\n+---+---------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193150_1832190156","id":"20181015-224231_2027590368","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:20:33+0000","dateFinished":"2018-10-30T22:20:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33919"},{"title":"What are the highest degree vertexes(most incoming and outgoing flights)?","text":"graph.degrees.orderBy(desc(\"degree\")).show()","user":"mapr","dateUpdated":"2018-10-30T22:21:20+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"fontSize":9,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+\n| id|degree|\n+---+------+\n|ORD| 12512|\n|ATL| 11983|\n|LGA|  9966|\n|MIA|  8864|\n|DEN|  8486|\n|EWR|  8428|\n|SFO|  7623|\n|BOS|  7423|\n|IAH|  7411|\n+---+------+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193151_-1431180641","id":"20181004-211413_1357524146","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:20:56+0000","dateFinished":"2018-10-30T22:20:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33920"},{"title":"What are the 4 most frequent flights in the dataset ? ","text":"graph.edges.groupBy(\"src\", \"dst\").count().orderBy(desc(\"count\")).show(4)","user":"mapr","dateUpdated":"2018-10-30T22:21:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-----+\n|src|dst|count|\n+---+---+-----+\n|ATL|LGA| 1271|\n|LGA|ATL| 1268|\n|LGA|ORD| 1107|\n|ORD|LGA| 1070|\n+---+---+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1540934193152_1404240926","id":"20181015-213933_2083506099","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:21:39+0000","dateFinished":"2018-10-30T22:21:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33921"},{"title":"Use Pagerank to find most important airports","text":"val ranks = graph.pageRank.resetProbability(0.15).maxIter(10).run()\n\nranks.vertices.orderBy($\"pagerank\".desc).show()","user":"mapr","dateUpdated":"2018-11-01T16:21:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ranks: org.graphframes.GraphFrame = GraphFrame(v:[id: string, City: string ... 3 more fields], e:[src: string, dst: string ... 11 more fields])\n+-------------+-------+-----+---+------------------+\n|         City|Country|State| id|          pagerank|\n+-------------+-------+-----+---+------------------+\n|      Chicago|    USA|   IL|ORD|1.3093391746897942|\n|      Atlanta|    USA|   GA|ATL|1.2643315314643362|\n|     New York|    USA|   NY|LGA|1.0647854334641227|\n|        Miami|    USA|   FL|MIA| 0.968294934036298|\n|       Newark|    USA|   NJ|EWR|0.9322291015836671|\n|       Denver|    USA|   CO|DEN|0.9318184799702145|\n|San Francisco|    USA|   CA|SFO|0.8558792499530563|\n|      Houston|    USA|   TX|IAH| 0.839762582192744|\n|       Boston|    USA|   MA|BOS|0.8335595126457667|\n+-------------+-------+-----+---+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193153_461845794","id":"20171107-112947_525619195","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:22:20+0000","dateFinished":"2018-10-30T22:22:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33922"},{"title":"Pregel Aggregate Messages to calculate avg delay","text":"    val AM = AggregateMessages\n    val msgToSrc = AM.edge(\"delay\")\n    val agg = {\n      graph.aggregateMessages\n        .sendToSrc(msgToSrc)\n        .agg(avg(AM.msg).as(\"avgdelay\"))\n        .orderBy(desc(\"avgdelay\"))\n        .limit(5)\n    }\n    agg.show()","user":"mapr","dateUpdated":"2018-11-01T16:22:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"AM: org.graphframes.lib.AggregateMessages.type = org.graphframes.lib.AggregateMessages$@639ca033\nmsgToSrc: org.apache.spark.sql.Column = edge['delay']\nagg: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, avgdelay: double]\n+---+------------------+\n| id|          avgdelay|\n+---+------------------+\n|SFO|20.306176084099867|\n|EWR| 16.31737378525717|\n|DEN|16.167720777699696|\n|IAH|15.925946093111898|\n|ORD|14.880476190476191|\n+---+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1540934193154_1656289128","id":"20171122-091021_1615582434","dateCreated":"2018-10-30T21:16:33+0000","dateStarted":"2018-10-30T22:22:52+0000","dateFinished":"2018-10-30T22:22:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33923"},{"user":"mapr","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540938172850_-90457751","id":"20181030-222252_1713457455","dateCreated":"2018-10-30T22:22:52+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:33924"}],"name":"/cmcdonald/sparkgraphflightdelays","id":"2DWFMCNVC","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}