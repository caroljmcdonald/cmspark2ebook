{"paragraphs":[{"title":"Import needed packages","text":"\nimport org.apache.spark._\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\n","user":"mapr","dateUpdated":"2018-11-02T19:29:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.thrift.transport.TTransportException\n\tat org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\n\tat org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\n\tat org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.recv_getFormType(RemoteInterpreterService.java:345)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.getFormType(RemoteInterpreterService.java:331)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$6.call(RemoteInterpreter.java:313)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$6.call(RemoteInterpreter.java:310)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.callRemoteFunction(RemoteInterpreterProcess.java:135)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:309)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:407)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:307)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"apps":[],"jobName":"paragraph_1541172194182_604942203","id":"20170508-144514_403247535","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T19:29:13+0000","dateFinished":"2018-11-02T19:29:13+0000","status":"ERROR","errorMessage":"org.apache.thrift.transport.TTransportException\n\tat org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\n\tat org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\n\tat org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.recv_getFormType(RemoteInterpreterService.java:345)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.getFormType(RemoteInterpreterService.java:331)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$6.call(RemoteInterpreter.java:313)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$6.call(RemoteInterpreter.java:310)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.callRemoteFunction(RemoteInterpreterProcess.java:135)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:309)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:407)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:307)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1313"},{"title":"Define Schema for JSON file data","text":"\n case class Flight(_id: String,fldate: String,month:Integer, dofW: Integer, carrier: String, origin: String,dest: String, crsdephour: Integer, crsdeptime: Integer, depdelay: Double, crsarrtime: Integer, arrdelay: Double, crselapsedtime: Double, dist: Double)\n  \n  val schema = StructType(Array(\n    StructField(\"_id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"origin\", StringType, true),\n    StructField(\"dest\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))\n","user":"mapr","dateUpdated":"2018-11-02T16:06:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Flight\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(_id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(origin,StringType,true), StructField(dest,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1541172194193_790382628","id":"20170508-150032_326029627","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:06:45+0000","dateFinished":"2018-11-02T16:06:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1314"},{"title":"Read the data from CSV file into a Dataset of Account type","text":" import spark.implicits._\n \n var file =\"maprfs:///user/mapr/data/flights2018.json\"\n  \n val df: Dataset[Flight] = spark.read.format(\"json\").option(\"inferSchema\", \"false\").schema(schema).load(file).as[Flight]\n \n df.take(10)\n\n\n\n","user":"mapr","dateUpdated":"2018-11-02T16:06:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nfile: String = maprfs:///user/mapr/data/flights2018.json\ndf: org.apache.spark.sql.Dataset[Flight] = [_id: string, fldate: string ... 12 more fields]\nres43: Array[Flight] = Array(Flight(EWR_DEN_2018-01-01_UA_2429,2018-01-01,1,1,UA,EWR,DEN,15,1517,0.0,1745,0.0,268.0,1605.0), Flight(EWR_ATL_2018-01-01_UA_2414,2018-01-01,1,1,UA,EWR,ATL,10,1044,11.0,1318,0.0,154.0,746.0), Flight(SFO_IAH_2018-01-01_UA_2405,2018-01-01,1,1,UA,SFO,IAH,5,530,0.0,1122,0.0,232.0,1635.0), Flight(BOS_SFO_2018-01-01_UA_2400,2018-01-01,1,1,UA,BOS,SFO,18,1820,6.0,2148,0.0,388.0,2704.0), Flight(ORD_MIA_2018-01-01_UA_2399,2018-01-01,1,1,UA,ORD,MIA,14,1405,0.0,1810,0.0,185.0,1197.0), Flight(MIA_IAH_2018-01-01_UA_2397,2018-01-01,1,1,UA,MIA,IAH,9,900,0.0,1056,0.0,176.0,964.0), Flight(EWR_LAX_2018-01-01_UA_2394,2018-01-01,1,1,UA,EWR,LAX,15,1500,15.0,1820,0.0,380.0,2454.0), Flight(SEA_IAH_2018-01-01_UA_2393,2018-01-01,1,1,UA,SEA,IAH,0,27,0.0,644,0.0,257.0,1874.0), Flight(D..."}]},"apps":[],"jobName":"paragraph_1541172194195_-311992007","id":"20170508-150131_378637203","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:06:49+0000","dateFinished":"2018-11-02T16:06:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1315"},{"text":"\ndf.count\ndf.filter($\"month\">6).show\n\n","user":"mapr","dateUpdated":"2018-11-02T16:10:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res57: Long = 328182\n+--------------------+----------+-----+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+\n|                 _id|    fldate|month|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+--------------------+----------+-----+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+\n|ATL_BOS_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| BOS|         9|       910|     0.0|      1150|     0.0|         160.0| 946.0|\n|ATL_BOS_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| BOS|        16|      1600|     1.0|      1840|     0.0|         160.0| 946.0|\n|ATL_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| DEN|        19|      1930|     0.0|      2055|     0.0|         205.0|1199.0|\n|ATL_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| DEN|        14|      1350|     0.0|      1500|     0.0|         190.0|1199.0|\n|ATL_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| DEN|        22|      2235|     4.0|      2355|     0.0|         200.0|1199.0|\n|ATL_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| DEN|         5|       545|     0.0|       650|     0.0|         185.0|1199.0|\n|ATL_LAX_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LAX|        15|      1535|     3.0|      1725|     0.0|         290.0|1947.0|\n|ATL_LAX_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LAX|        20|      2015|     0.0|      2205|     0.0|         290.0|1947.0|\n|ATL_LAX_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LAX|         8|       845|     9.0|      1030|     0.0|         285.0|1947.0|\n|ATL_LGA_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LGA|        17|      1700|     2.0|      1920|     0.0|         140.0| 762.0|\n|ATL_LGA_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LGA|         6|       645|    39.0|       855|    26.0|         130.0| 762.0|\n|ATL_LGA_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LGA|        19|      1925|     5.0|      2150|     0.0|         145.0| 762.0|\n|ATL_LGA_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LGA|         9|       900|     0.0|      1120|     0.0|         140.0| 762.0|\n|ATL_LGA_2018-07-0...|2018-07-01|    7|   7|     WN|   ATL| LGA|        12|      1210|     0.0|      1425|     0.0|         135.0| 762.0|\n|BOS_ATL_2018-07-0...|2018-07-01|    7|   7|     WN|   BOS| ATL|         7|       710|     0.0|      1005|     0.0|         175.0| 946.0|\n|BOS_ATL_2018-07-0...|2018-07-01|    7|   7|     WN|   BOS| ATL|        18|      1830|     0.0|      2135|     0.0|         185.0| 946.0|\n|BOS_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   BOS| DEN|         5|       530|     0.0|       805|     0.0|         275.0|1754.0|\n|BOS_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   BOS| DEN|        18|      1830|     1.0|      2125|     7.0|         295.0|1754.0|\n|BOS_DEN_2018-07-0...|2018-07-01|    7|   7|     WN|   BOS| DEN|        11|      1130|   101.0|      1410|    74.0|         280.0|1754.0|\n|DEN_ATL_2018-07-0...|2018-07-01|    7|   7|     WN|   DEN| ATL|         9|       920|     5.0|      1415|     0.0|         175.0|1199.0|\n+--------------------+----------+-----+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541172194198_-1702344973","id":"20181016-220646_1410121935","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:10:58+0000","dateFinished":"2018-11-02T16:11:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1316"},{"text":"val df1 = df.withColumnRenamed(\"_id\", \"id\").withColumnRenamed(\"origin\", \"src\").withColumnRenamed(\"dest\", \"dst\")\ndf1.show  ","user":"mapr","dateUpdated":"2018-11-02T16:11:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 12 more fields]\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+------+\n|                  id|    fldate|month|dofW|carrier|src|dst|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+------+\n|EWR_DEN_2018-01-0...|2018-01-01|    1|   1|     UA|EWR|DEN|        15|      1517|     0.0|      1745|     0.0|         268.0|1605.0|\n|EWR_ATL_2018-01-0...|2018-01-01|    1|   1|     UA|EWR|ATL|        10|      1044|    11.0|      1318|     0.0|         154.0| 746.0|\n|SFO_IAH_2018-01-0...|2018-01-01|    1|   1|     UA|SFO|IAH|         5|       530|     0.0|      1122|     0.0|         232.0|1635.0|\n|BOS_SFO_2018-01-0...|2018-01-01|    1|   1|     UA|BOS|SFO|        18|      1820|     6.0|      2148|     0.0|         388.0|2704.0|\n|ORD_MIA_2018-01-0...|2018-01-01|    1|   1|     UA|ORD|MIA|        14|      1405|     0.0|      1810|     0.0|         185.0|1197.0|\n|MIA_IAH_2018-01-0...|2018-01-01|    1|   1|     UA|MIA|IAH|         9|       900|     0.0|      1056|     0.0|         176.0| 964.0|\n|EWR_LAX_2018-01-0...|2018-01-01|    1|   1|     UA|EWR|LAX|        15|      1500|    15.0|      1820|     0.0|         380.0|2454.0|\n|SEA_IAH_2018-01-0...|2018-01-01|    1|   1|     UA|SEA|IAH|         0|        27|     0.0|       644|     0.0|         257.0|1874.0|\n|DEN_ORD_2018-01-0...|2018-01-01|    1|   1|     UA|DEN|ORD|         9|       915|     0.0|      1242|     0.0|         147.0| 888.0|\n|MIA_ORD_2018-01-0...|2018-01-01|    1|   1|     UA|MIA|ORD|         7|       729|     0.0|       950|     0.0|         201.0|1197.0|\n|EWR_IAH_2018-01-0...|2018-01-01|    1|   1|     UA|EWR|IAH|        20|      1959|     1.0|      2308|     0.0|         249.0|1400.0|\n|DEN_EWR_2018-01-0...|2018-01-01|    1|   1|     UA|DEN|EWR|        20|      2025|     0.0|       202|     0.0|         217.0|1605.0|\n|ORD_CLT_2018-01-0...|2018-01-01|    1|   1|     UA|ORD|CLT|        21|      2101|    26.0|         3|     0.0|         122.0| 599.0|\n|LAX_DEN_2018-01-0...|2018-01-01|    1|   1|     UA|LAX|DEN|        16|      1558|     0.0|      1924|     0.0|         146.0| 862.0|\n|SFO_BOS_2018-01-0...|2018-01-01|    1|   1|     UA|SFO|BOS|        22|      2240|     0.0|       717|     0.0|         337.0|2704.0|\n|LAX_ORD_2018-01-0...|2018-01-01|    1|   1|     UA|LAX|ORD|        15|      1540|     0.0|      2135|     0.0|         235.0|1744.0|\n|EWR_ORD_2018-01-0...|2018-01-01|    1|   1|     UA|EWR|ORD|        16|      1646|    12.0|      1827|     9.0|         161.0| 719.0|\n|IAH_ORD_2018-01-0...|2018-01-01|    1|   1|     UA|IAH|ORD|        19|      1945|     5.0|      2219|     4.0|         154.0| 925.0|\n|LAX_EWR_2018-01-0...|2018-01-01|    1|   1|     UA|LAX|EWR|        16|      1625|     0.0|        25|     0.0|         300.0|2454.0|\n|SFO_MIA_2018-01-0...|2018-01-01|    1|   1|     UA|SFO|MIA|         8|       820|     0.0|      1646|     0.0|         326.0|2585.0|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541172194202_-1128621627","id":"20181022-172105_736273780","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:11:17+0000","dateFinished":"2018-11-02T16:11:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1317"},{"text":"df1.count","user":"mapr","dateUpdated":"2018-11-02T16:11:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res62: Long = 328182\n"}]},"apps":[],"jobName":"paragraph_1541172194217_193743579","id":"20171118-063819_25280485","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:11:25+0000","dateFinished":"2018-11-02T16:11:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1318"},{"text":"import com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._","user":"mapr","dateUpdated":"2018-11-02T16:11:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\n"}]},"apps":[],"jobName":"paragraph_1541172194221_-193106795","id":"20181017-211020_1475616952","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:11:32+0000","dateFinished":"2018-11-02T16:11:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1319"},{"text":"var tableName = \"/user/mapr/flighttable\"\ndf1.saveToMapRDB(tableName, createTable = false, idFieldPath = \"id\")","user":"mapr","dateUpdated":"2018-11-02T16:11:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tableName: String = /user/mapr/flighttable\n"}]},"apps":[],"jobName":"paragraph_1541172194225_1357887820","id":"20171118-080916_1359229211","dateCreated":"2018-11-02T15:23:14+0000","dateStarted":"2018-11-02T16:11:41+0000","dateFinished":"2018-11-02T16:11:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1320"},{"text":"  case class Flight(id: String,fldate: String,month:Integer, dofW: Integer, carrier: String, src: String,dst: String, crsdephour: Integer, crsdeptime: Integer, depdelay: Double, crsarrtime: Integer, arrdelay: Double, crselapsedtime: Double, dist: Double)\n  \n  val schema = StructType(Array(\n    StructField(\"id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"src\", StringType, true),\n    StructField(\"dst\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))","user":"mapr","dateUpdated":"2018-11-02T16:11:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Flight\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(src,StringType,true), StructField(dst,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1541173748018_1942498137","id":"20181102-154908_1434584542","dateCreated":"2018-11-02T15:49:08+0000","dateStarted":"2018-11-02T16:11:51+0000","dateFinished":"2018-11-02T16:11:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1321"},{"text":"\n import com.mapr.db.spark._\n val spark: SparkSession = SparkSession.builder().appName(\"flightread\").getOrCreate()\n \n // load payment dataset from MapR-DB \nval df2 = spark.sparkSession.loadFromMapRDB[Flight](tableName, schema)\n\n//val df: Dataset[Flight] = spark.sparkSession.loadFromMapRDB[Flight](tableName, schema).as[Flight]\n \n df2.take(2)\n df2.count\n df2.show\n ","user":"mapr","dateUpdated":"2018-11-02T16:11:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mapr.db.spark._\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@23e66211\ndf2: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 12 more fields]\nres70: Array[org.apache.spark.sql.Row] = Array([ATL_BOS_2018-01-01_DL_104,2018-01-01,1,1,DL,ATL,BOS,9,850,0.0,1116,0.0,146.0,946.0], [ATL_BOS_2018-01-01_DL_1200,2018-01-01,1,1,DL,ATL,BOS,11,1122,8.0,1349,0.0,147.0,946.0])\nres71: Long = 282628\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+\n|                  id|    fldate|month|dofW|carrier|src|dst|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|         9|       850|     0.0|      1116|     0.0|         146.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        11|      1122|     8.0|      1349|     0.0|         147.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        14|      1356|     9.0|      1623|     0.0|         147.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     3.0|         151.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        19|      1940|     6.0|      2210|     0.0|         150.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        12|      1248|     0.0|      1513|     0.0|         145.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        22|      2215|     0.0|        39|     0.0|         144.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        15|      1500|    21.0|      1734|    33.0|         154.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        15|      1500|   198.0|      1725|   208.0|         145.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        21|      2055|    14.0|      2330|     0.0|         155.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        10|      1015|   215.0|      1250|   191.0|         155.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|         9|       850|     9.0|      1116|     0.0|         146.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        11|      1123|     0.0|      1350|     0.0|         147.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        10|      1000|    22.0|      1232|    10.0|         152.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        14|      1356|     6.0|      1623|    21.0|         147.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        22|      2227|     8.0|        51|     0.0|         144.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     0.0|         151.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        19|      1940|    62.0|      2210|    50.0|         150.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        12|      1248|    15.0|      1513|     7.0|         145.0|946.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        21|      2107|    12.0|      2335|    29.0|         148.0|946.0|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541173721362_-1118476912","id":"20181102-154841_1428215689","dateCreated":"2018-11-02T15:48:41+0000","dateStarted":"2018-11-02T16:11:57+0000","dateFinished":"2018-11-02T16:12:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1322"},{"text":"df2.write.format(\"parquet\").partitionBy(\"src\").option(\"path\", \"/user/mapr/data/flights\").saveAsTable(\"flights\")","user":"mapr","dateUpdated":"2018-11-02T16:14:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1541175158170_1968767798","id":"20181102-161238_2111861117","dateCreated":"2018-11-02T16:12:38+0000","dateStarted":"2018-11-02T16:14:04+0000","dateFinished":"2018-11-02T16:14:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1323"},{"text":" var dir =\"maprfs:///user/mapr/data/flightsjson\"\n val df3 =  df2.orderBy(org.apache.spark.sql.functions.col(\"fldate\"))\n val df4 = df3.coalesce(1)\n df4.write.format(\"json\").save(dir)","user":"mapr","dateUpdated":"2018-11-02T16:20:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dir: String = maprfs:///user/mapr/data/flightsjson\ndf3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, fldate: string ... 12 more fields]\ndf4: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, fldate: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1541175214735_-1387197141","id":"20181102-161334_2139722966","dateCreated":"2018-11-02T16:13:34+0000","dateStarted":"2018-11-02T16:20:11+0000","dateFinished":"2018-11-02T16:20:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1324"},{"text":"%sh\nhadoop fs -ls /user/mapr/data","user":"mapr","dateUpdated":"2018-11-02T15:23:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 8 items\n-rwxr-xr-x   3 mapr mapr        533 2018-10-15 19:48 /user/mapr/data/airports.json\n-rwxr-xr-x   3 mapr mapr    8827642 2018-10-15 19:48 /user/mapr/data/flights20170102.json\n-rwxr-xr-x   3 mapr mapr    9972950 2018-10-17 19:26 /user/mapr/data/flightsjan2018.json\ndrwxr-xr-x   - mapr mapr          2 2018-10-17 20:12 /user/mapr/data/march\n-rwxr-xr-x   3 mapr mapr   43253686 2018-10-17 16:56 /user/mapr/data/reporting1.csv\n-rwxr-xr-x   3 mapr mapr   39573073 2018-10-17 16:56 /user/mapr/data/reporting2.csv\n-rwxr-xr-x   3 mapr mapr   46436752 2018-10-17 16:56 /user/mapr/data/reporting3.csv\n-rwxr-xr-x   3 mapr mapr   46436752 2018-10-17 16:56 /user/mapr/data/reporting4.csv\n"}]},"apps":[],"jobName":"paragraph_1541172194228_1095361612","id":"20181016-230411_2118195097","dateCreated":"2018-11-02T15:23:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1325"},{"text":"%sh\nhadoop fs -ls /user/mapr/dir","user":"mapr","dateUpdated":"2018-11-02T15:23:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/mapr/hadoop/hadoop-2.7.0/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/mapr/lib/slf4j-log4j12-1.7.12.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 3 items\n-rwxr-xr-x   3 mapr mapr          0 2018-10-16 22:38 /user/mapr/dir/_SUCCESS\n-rwxr-xr-x   3 mapr mapr     457385 2018-10-16 22:38 /user/mapr/dir/part-00000-7edf1074-f0d9-43f3-a8b6-1455c1b14896.json\n-rwxr-xr-x   3 mapr mapr     317412 2018-10-16 22:38 /user/mapr/dir/part-00001-7edf1074-f0d9-43f3-a8b6-1455c1b14896.json\n"}]},"apps":[],"jobName":"paragraph_1541172194231_-945772471","id":"20181016-225545_1187782973","dateCreated":"2018-11-02T15:23:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1326"},{"text":"%sh\n","user":"mapr","dateUpdated":"2018-11-02T15:23:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541172194233_2089559756","id":"20181016-230451_1451902060","dateCreated":"2018-11-02T15:23:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1327"}],"name":"/cmcdonald/flightwritemaprdb-graph","id":"2DW7MT1KG","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}